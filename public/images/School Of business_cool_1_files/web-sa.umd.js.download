var _excluded8=["activity_name","activity_param"];function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _objectWithoutProperties2(e,t){if(null==e)return{};var n,i,r=_objectWithoutPropertiesLoose2(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose2(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty2(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _classCallCheck2(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,_toPropertyKey2(i.key),i)}}function _createClass2(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty2(e,t,n){return(t=_toPropertyKey2(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey2(e){var t=_toPrimitive2(e,"string");return"symbol"==_typeof2(t)?t:t+""}function _toPrimitive2(e,t){if("object"!=_typeof2(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=_typeof2(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";var e,t,n,i=function(e){try{var t=localStorage.getItem(e);if(!t)return null;var n=JSON.parse(t),i=n.value,r=n.expire;return void 0!==r&&(new Date).getTime()>r?(localStorage.removeItem(e),null):i}catch(o){return console.error("getLocalStorage error: "+(null==o?void 0:o.message)),null}},r=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null},o=function(e,t){var n;switch(t){case"error":n=console.error;break;case"warn":n=console.warn;break;default:n=console.info}"undefined"!=typeof window&&n(e)},a=function(){var e=navigator.userAgent.toLowerCase();return/(iphone os|midp|rv:1.2.3.4|ucweb|android|windows ce|windows mobile)/i.test(e)?"Phone":/ipad/i.test(e)?"Tablet":"Desktop"},s=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},c=Object.assign({is_report_general_point:!0,heart_interval:60,silent_times:30},(null===(e=window.SA_GLOBAL_CONFIG)||void 0===e?void 0:e.heartbeat)||null),u=function(){return _createClass2((function e(t){var n=this;_classCallCheck2(this,e),_defineProperty2(this,"inactivityCounter",0),_defineProperty2(this,"heartbeatTimer",0),_defineProperty2(this,"dispatch",void 0),_defineProperty2(this,"heartNo",0),c.is_report_general_point&&(+c.heart_interval<10&&(c.heart_interval=10),this.dispatch=function(){var e=function(){t("heart_active",{heart_interval:n.heartNo>0?c.heart_interval:0,heart_no:++n.heartNo}),sessionStorage.setItem("sa_analytics",JSON.stringify({heart_no:n.heartNo}))};"function"==typeof requestIdleCallback?requestIdleCallback(e):e()},this.startCounter())}),[{key:"startCounter",value:function(){var e=this;this.startHeartbeat();var t=function(){document.hidden?e.endHeartbeat():e.startHeartbeat()};document.hidden?document.addEventListener("visibilitychange",t):"mozHidden"in document?document.addEventListener("mozvisibilitychange",t):"webkitHidden"in document?document.addEventListener("webkitvisibilitychange",t):"msHidden"in document?document.addEventListener("msvisibilitychange",t):"onfocusin"in document?(s(window,"focusin",(function(){e.startHeartbeat()})),s(window,"focusout",(function(){e.startHeartbeat()}))):(s(window,"focus",(function(){e.startHeartbeat()})),s(window,"blur",(function(){e.endHeartbeat()})),s(window,"pageshow",(function(){e.startHeartbeat()})),s(window,"pagehide",(function(){e.endHeartbeat()})));var n=function(){e.inactivityCounter>=c.silent_times&&e.startHeartbeat(),e.inactivityCounter=0};s(window,"mousemove",n),s(window,"click",n),s(window,"keydown",n),s(window,"scroll",n),s(window,"beforeunload",(function(){e.endHeartbeat()})),s(window,"unload",(function(){e.endHeartbeat()})),setInterval((function(){e.inactivityCounter++,0!==e.heartbeatTimer&&e.inactivityCounter>=c.silent_times&&e.endHeartbeat()}),1e3*c.heart_interval)}},{key:"startHeartbeat",value:function(){this.initHeartbeatTimer()}},{key:"endHeartbeat",value:function(){window.clearInterval(this.heartbeatTimer),this.heartbeatTimer=0}},{key:"initHeartbeatTimer",value:function(){if(this.heartbeatTimer)return!1;this.heartbeatTimer=window.setInterval(this.dispatch,1e3*c.heart_interval),this.dispatch()}}])}();function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,f(i.key),i)}}function f(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}_defineProperty2(u,"type","CLASS"),_defineProperty2(u,"name","heartbeat");var h=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"get",value:function(){var e,t,n;return"undefined"!=typeof window&&((null===(e=window)||void 0===e||null===(e=e.GLOBAL_SN_OEST)||void 0===e?void 0:e.getValue())||(t="cookieId",(n=("; "+document.cookie).split("; "+t+"=")).length>=2?decodeURIComponent(n.pop().split(";").shift()):""))||""}}],(t=null)&&d(e.prototype,t),n&&d(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}(),p="1.1.1",v=function(){return _createClass2((function e(t,n){_classCallCheck2(this,e),_defineProperty2(this,"config",void 0),_defineProperty2(this,"_SDK_",void 0),_defineProperty2(this,"sessionId",{key:"bi_session_id",duration:18e5,refreshTime:2e3,timer:0,value:""}),this._SDK_=t,this.config=n}),[{key:"getOSType",value:function(e){var t,n=a(),i={h5:function(){return"Phone"==n||"Tablet"==n?0:"Desktop"==n?1:2},pc:function(){return"Phone"==n||"Tablet"==n?0:"Desktop"==n?1:2},pwa:function(){var e,t=r("from"),n=!1;try{e=sessionStorage.getItem("pwa-fullscreen")}catch(i){}return("fullscreen"==t||e)&&(n=!0),n?4:3}};return(null===(t=i[e])||void 0===t?void 0:t.call(i))||""}},{key:"getSaDeviceClass",value:function(){var e=a();return"Phone"==e?0:"Desktop"==e?1:"Tablet"==e?2:3}},{key:"getValueFromStorage",value:function(e){var t=e||{},n=t.cookieKey,r=t.cookieValueDefault,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.cookie;if(!t)return"";function n(e){var t={},n=e.split(/; */);function i(e,t){try{return t(e)}catch(n){return e}}for(var r=0;r<n.length;r++){var o=n[r],a=o.indexOf("=");if(!(a<0)){var s=o.substr(0,a).trim(),c=o.substr(++a,o.length).trim();'"'==c[0]&&(c=c.slice(1,-1)),null==t[s]&&(t[s]=i(c,decodeURIComponent))}}return t}function i(e){if("string"==typeof e&&"j:"===e.substr(0,2))try{return JSON.parse(e.slice(2))}catch(t){return}}function r(e){for(var t,n,r=Object.keys(e),o=0;o<r.length;o++)(n=i(e[t=r[o]]))&&(e[t]=n);return e}return r(n(t))[e]||""}(n)||i(n)||"";return!o&&r&&(o=r),o}},{key:"setSessionId",value:function(e){!function(e){var t=e.key,n=e.value,i=e.expire;try{var r={value:n,expire:void 0!==i?(new Date).getTime()+i:void 0};localStorage.setItem(t,JSON.stringify(r))}catch(o){console.error("set localStorage error: "+(null==o?void 0:o.message))}}({key:this.sessionId.key,value:e,expire:this.sessionId.duration})}},{key:"getSessionId",value:function(){var e=this,t="";try{(t=i(this.sessionId.key))?(this.sessionId.timer&&clearTimeout(this.sessionId.timer),this.sessionId.timer=setTimeout((function(){e.setSessionId(t)}),this.sessionId.refreshTime)):(t=this.sessionId.value||"bi_"+(new Date).getTime()+"_"+Math.floor(1e5*Math.random()),this.setSessionId(t))}catch(n){}return this.sessionId.value||(this.sessionId.value=t),this.sessionId.value}},{key:"initAction",value:function(e,t){var n,o,a,s,c,l=this,d=t.sendAction,f=e.environment,v=e.host,g=void 0===v?"srmdata.abc-test.sheincorp.cn":v,m=e.homeSite,b=e.deviceType,w=e.cookieId,y=e.SiteUID,_=e.appLanguage,k=e.registerFields,x=void 0===k?{}:k,P=e.config,S=void 0===P?{}:P,T=["pc","pwa"].includes(b)?b:"h5",O=T;if(!g)return console.error("[@shein-aidc/basis-sa]","host缺失，请进行初始化并配置埋点上报地址"),{applyFor:O};var I,C,j,E=[];(null!==(n=this.config)&&void 0!==n&&n.multichannel||"h5"===T||E.push((I=function(e,t){d({activity_name:e,activity_param:t})},{name:"heart-beat",immediate:!0,handle:function(){new u(I)}})),this._SDK_.init({url:{fetch:"".concat(location.protocol,"//").concat(g,"/msg"),ajax:"".concat(location.protocol,"//").concat(g,"/msg"),image:"".concat(location.protocol,"//").concat(g,"/topic"),beacon:"".concat(location.protocol,"//").concat(g,"/beacon")},sm_device_id:window.__SmDeviceId||(null===(o=window)||void 0===o||null===(o=o.sessionStorage)||void 0===o?void 0:o.getItem("SmDeviceId"))||"",brand:m,hooks:null===(a=this.config)||void 0===a?void 0:a.hooks,log:"production"!=f||!(null===(s=window)||void 0===s||null===(s=s.sessionStorage)||void 0===s||!s.getItem("sa-debug")),plugins:E,config:S}),this._SDK_.register(_objectSpread2({environment:f,sub_site:y,language:_,device_type:b,sdk_version:p,os_type:this.getOSType(O),device_class:this.getSaDeviceClass()+"".concat("h5"==O?"_h5":""),cookie_id:"h5"==O?w?function(){return l.getValueFromStorage(w)}:"":function(){return h.get()||""},session_id:function(){return l.getSessionId()},channel:function(){return r("url_from")||""},origin_otherid:function(){return i("originOtherId")||""}},x)),null!==(c=this.config)&&void 0!==c&&c.multichannel)||(null===(C=this.config)||void 0===C||null===(C=C.on)||void 0===C||null===(j=C.init)||void 0===j||j.call(C,e));return{applyFor:O}}}])}(),g=["params"],m=["able"],b=["send_type","headers"],w=["data"],y=["plugins"],_=["name","params"],k=["name","params"];function x(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function S(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
S=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(R){u=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new j(i||[]);return r(a,"_invoke",{value:T(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(i){return{type:"throw",arg:i}}}t.wrap=l;var f="suspendedStart",h="executing",p="completed",v={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var y=Object.getPrototypeOf,_=y&&y(y(E([])));_&&_!==n&&i.call(_,a)&&(w=_);var k=b.prototype=g.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(r,o,a,s){var c=d(e[r],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==N(l)&&i.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(e,i){function r(){return new t((function(t,r){n(e,i,t,r)}))}return o=o?o.then(r,r):r()}})}function T(t,n,i){var r=f;return function(o,a){if(r===h)throw Error("Generator is already running");if(r===p){if("throw"===o)throw a;return{value:e,done:!0}}for(i.method=o,i.arg=a;;){var s=i.delegate;if(s){var c=O(s,i);if(c){if(c===v)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===f)throw r=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=h;var u=d(t,n,i);if("normal"===u.type){if(r=i.done?p:"suspendedYield",u.arg===v)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=p,i.method="throw",i.arg=u.arg)}}}function O(t,n){var i=n.method,r=t.iterator[i];if(r===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),v;var o=d(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function E(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(N(t)+" is not iterable")}return m.prototype=b,r(k,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,u(e,c,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},x(P.prototype),u(P.prototype,s,(function(){return this})),t.AsyncIterator=P,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var a=new P(l(e,n,i,r),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(k),u(k,c,"Generator"),u(k,a,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=E,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(C),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return s.type="throw",s.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;C(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:E(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}function T(e,t,n,i,r,o,a){try{var s=e[o](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(i,r)}function O(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){T(o,i,r,a,s,"next",e)}function s(e){T(o,i,r,a,s,"throw",e)}a(void 0)}))}}function I(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,L(i.key),i)}}function R(e,t,n){return t&&E(e.prototype,t),n&&E(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t,n){return(t=L(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e){var t=function(e,t){if("object"!=N(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=N(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==N(t)?t:t+""}function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var F=Object.defineProperty,q=function(e,t,n){return function(e,t,n){t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!==N(t)?t+"":t,n),n},M="undefined",U="object",H="string",W="function",z="device",K="os",B="result",J="model",G="name",Q="type",V="vendor",$="version",X="mobile",Y="tablet",Z="Amazon",ee="Apple",te="ASUS",ne="BlackBerry",ie="Google",re="Huawei",oe="Microsoft",ae="Motorola",se="Samsung",ce="Sony",ue="Xiaomi",le="Zebra",de="architecture",fe="brands",he="fullVersionList",pe="platform",ve="platformVersion",ge="bitness",me="sec-ch-ua",be="sec-ch-ua-platform",we="browser",ye="major",_e="Opera",ke=[fe,he,X,J,pe,ve,de,ge],xe=function(e,t){for(var n in t)if(N(t[n])===U&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(Se(t[n][i],e))return"?"===n?void 0:n}else if(Se(t[n],e))return"?"===n?void 0:n;return e},Pe=function(e,t){for(var n in t){var i=t[n];N(i)===U&&2==i.length?e[i[0]]=i[1]:e[i]=void 0}return e},Se=function(e,t){if(N(e)===U&&e.length>0){for(var n in e)if(Oe(e[n])==Oe(t))return!0;return!1}return N(e)===H&&-1!==Oe(t).indexOf(Oe(e))},Te=function(e){if(e){for(var t=[],n=Ie(/\\?\"/g,e).split(", "),i=0;i<n.length;i++){var r=n[i].split(";v=");t[i]={brand:r[0],version:r[1]}}return t}},Oe=function(e){return N(e)===H?e.toLowerCase():e},Ie=function(e,t){return t.replace(e,"")},Ce=function(e){return N(e)===H?Ie(/\"/g,e):e},je={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Ee={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[$,[G,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[$,[G,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[G,$],[/opios[\/ ]+([\w\.]+)/i],[$,[G,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[$,[G,_e]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[G,$],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[$,[G,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[$,[G,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[$,[G,"WeChat"]],[/konqueror\/([\w\.]+)/i],[$,[G,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[$,[G,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[$,[G,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[G,/(.+)/,"$1 Secure Browser"],$],[/\bfocus\/([\w\.]+)/i],[$,[G,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[$,[G,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[$,[G,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[$,[G,"Dolphin"]],[/coast\/([\w\.]+)/i],[$,[G,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[$,[G,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[$,[G,"Mobile Firefox"]],[/\bqihu|(qi?ho?o?|360)browser/i],[[G,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[G,/(.+)/,"$1 Browser"],$],[/(comodo_dragon)\/([\w\.]+)/i],[[G,/_/g," "],$],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[G,$],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[G],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[G,"Facebook"],$],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[G,$],[/\bgsa\/([\w\.]+) .*safari\//i],[$,[G,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[$,[G,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[$,[G,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[G,"Chrome WebView"],$],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[$,[G,"Android Browser"]],[/chrome\/([\w\.]+) mobile/i],[$,[G,"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[G,$],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[$,[G,"Mobile Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[G,"Mobile Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[$,G],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[G,[$,xe,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[G,$],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[G,"Mobile Firefox"],$],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[G,"Netscape"],$],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[$,[G,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[G,$],[/(cobalt)\/([\w\.]+)/i],[G,[$,/[^\d\.]+./,""]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[J,[V,se],[Q,Y]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[J,[V,se],[Q,X]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[J,[V,ee],[Q,X]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[J,[V,ee],[Q,Y]],[/(macintosh);/i],[J,[V,ee]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[J,[V,"Sharp"],[Q,X]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[J,[V,re],[Q,Y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[J,[V,re],[Q,X]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[J,/_/g," "],[V,ue],[Q,X]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[J,/_/g," "],[V,ue],[Q,Y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[J,[V,"OPPO"],[Q,X]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[J,[V,"Vivo"],[Q,X]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[J,[V,"Realme"],[Q,X]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[J,[V,ae],[Q,X]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[J,[V,ae],[Q,Y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[J,[V,"LG"],[Q,Y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[J,[V,"LG"],[Q,X]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[J,[V,"Lenovo"],[Q,Y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[J,/_/g," "],[V,"Nokia"],[Q,X]],[/(pixel c)\b/i],[J,[V,ie],[Q,Y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[J,[V,ie],[Q,X]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[J,[V,ce],[Q,X]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[J,"Xperia Tablet"],[V,ce],[Q,Y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[J,[V,"OnePlus"],[Q,X]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[J,[V,Z],[Q,Y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[J,/(.+)/g,"Fire Phone $1"],[V,Z],[Q,X]],[/(playbook);[-\w\),; ]+(rim)/i],[J,V,[Q,Y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[J,[V,ne],[Q,X]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[J,[V,te],[Q,Y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[J,[V,te],[Q,X]],[/(nexus 9)/i],[J,[V,"HTC"],[Q,Y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[V,[J,/_/g," "],[Q,X]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[J,[V,"Acer"],[Q,Y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[J,[V,"Meizu"],[Q,X]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[V,J,[Q,X]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[V,J,[Q,Y]],[/(surface duo)/i],[J,[V,oe],[Q,Y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[J,[V,"Fairphone"],[Q,X]],[/(shield[\w ]+) b/i],[J,[V,"Nvidia"],[Q,Y]],[/(sprint) (\w+)/i],[V,J,[Q,X]],[/(kin\.[onetw]{3})/i],[[J,/\./g," "],[V,oe],[Q,X]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[J,[V,le],[Q,Y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[J,[V,le],[Q,X]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[J,[Q,X]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[J,[Q,Y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[Q,Y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[Q,X]],[/(android[-\w\. ]{0,9});.+buil/i],[J,[V,"Generic"]]],os:[[/microsoft (windows) (vista|xp)/i],[G,$],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[G,[$,xe,je]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[G,"Windows"],[$,xe,je]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[$,/_/g,"."],[G,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[G,"Mac OS"],[$,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[$,G],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[G,$],[/\(bb(10);/i],[$,[G,ne]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[$,[G,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[$,[G,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[$,[G,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[$,[G,"watchOS"]],[/crkey\/([\d\.]+)/i],[$,[G,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[G,"Chrome OS"],$],[/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[G,$],[/(sunos) ?([\w\.\d]*)/i],[[G,"Solaris"],$],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[G,$]]},Re="undefined"==typeof window?void 0:window.navigator,De=(null==Re?void 0:Re.userAgentData)||void 0,Ae={init:A(A(A({},"".concat(we),[G,$,ye]),"".concat(z),[Q,J,V]),"".concat(K),[G,$]),isIgnore:A(A({},"".concat(we),[$,ye]),"".concat(K),[$]),isIgnoreRgx:A(A({},"".concat(we),/ ?browser$/i),"".concat(K),/ ?os$/i),toString:A(A(A({},"".concat(we),[G,$]),"".concat(z),[V,J]),"".concat(K),[G,$])},Le=R((function e(t,n){if(D(this,e),t=t||{},Pe(this,ke),n)Pe(this,[[fe,Te(t[me])],[he,Te(t["sec-ch-ua-full-version-list"])],[X,/\?1/.test(t["sec-ch-ua-mobile"])],[J,Ce(t["sec-ch-ua-model"])],[pe,Ce(t[be])],[ve,Ce(t["sec-ch-ua-platform-version"])],[de,Ce(t["sec-ch-ua-arch"])],[ge,Ce(t["sec-ch-ua-bitness"])]]);else for(var i in t)this.hasOwnProperty(i)&&N(t[i])!==M&&(this[i]=t[i]);return this})),Ne=function(){return R((function e(t,n,i,r){if(D(this,e),q(this,"itemType"),q(this,"ua"),q(this,"rgxMap"),q(this,"uaCH"),q(this,"data"),this.itemType=t,this.ua=n,this.rgxMap=i,this.uaCH=r,this.data=function(e){var t=Ae.init[e];return new(R((function e(){D(this,e),Pe(this,t)})))}(t),this.itemType==B){var o=function(t){return new e(t,n,i[t],r).parseUA().get()};this.set("ua",n).set(we,o(we)).set(z,o(z)).set(K,o(K)).get()}return this}),[{key:"detectFeature",value:function(){var e,t=Re&&Re.userAgent==this.ua;switch(this.itemType){case we:t&&(null==Re?void 0:Re.brave)&&N(Re.brave.isBrave)==W&&this.set(G,"Brave"),this.set(ye,N(e=this.get($))===H?Ie(/[^\d\.]/g,e).split(".")[0]:void 0);break;case z:t&&!this.get(Q)&&De&&De.mobile&&this.set(Q,X),t&&"Macintosh"==this.get(J)&&Re&&N(Re.standalone)!==M&&Re.maxTouchPoints&&Re.maxTouchPoints>2&&this.set(J,"iPad").set(Q,Y);break;case K:t&&!this.get(G)&&De&&De.platform&&this.set(G,De.platform)}return this}},{key:"get",value:function(e){return e?this.data.hasOwnProperty(e)?this.data[e]:void 0:this.data}},{key:"parseUA",value:function(){return this.itemType!=B&&function(e,t,n){if(t&&n)for(var i,r,o,a,s,c,u=0;u<n.length&&!s;){var l=n[u],d=n[u+1];for(i=r=0;i<l.length&&!s&&l[i];)if(s=l[i++].exec(t))for(o=0;o<d.length;o++)c=s[++r],N(a=d[o])===U&&a.length>0?2===a.length?N(a[1])===W?e[a[0]]=a[1].call(e,c):e[a[0]]=a[1]:3===a.length?N(a[1])!==W||a[1].exec&&a[1].test?e[a[0]]=c?c.replace(a[1],a[2]):void 0:e[a[0]]=c?a[1].call(e,c,a[2]):void 0:4===a.length&&(e[a[0]]=c?a[3].call(e,c.replace(a[1],a[2])):void 0):e[a]=c||void 0;u+=2}}(this.data,this.ua,this.rgxMap),this.detectFeature(),this}},{key:"set",value:function(e,t){return this.data[e]=t,this}}])}(),Fe=function(){function e(t){D(this,e),q(this,"userAgent",""),q(this,"httpUach",{}),this.init(t)}return R(e,[{key:"init",value:function(t){return this instanceof e?(this.userAgent=t||(null==Re?void 0:Re.userAgent)||"",this.httpUach=new Le({},!0),this.setUA(this.userAgent),this):new e(t).getResult()}},{key:"createUAParserItemFunc",value:function(e){var t=e===B?Ee:Ee[e];return new Ne(e,this.userAgent,t,this.httpUach).parseUA().get()}},{key:"getBrowser",value:function(){return this.createUAParserItemFunc(we)}},{key:"getDevice",value:function(){return this.createUAParserItemFunc(z)}},{key:"getOS",value:function(){return this.createUAParserItemFunc(K)}},{key:"getUA",value:function(){return this.userAgent}},{key:"setUA",value:function(e){var t,n;return this.userAgent=N(e)===H&&e.length>350?(n=350,N(t=e)===H?(t=Ie(/^\s\s*/,t),N(n)===M?t:t.substring(0,350)):""):e,this}},{key:"getResult",value:function(){return this.createUAParserItemFunc(B)}}])}(),qe={};var Me={activity_name:"",activity_param:"",device_type:"",home_site:"",sub_site:"",language:"",system_language:"",money_type:"",device_country:"",app_versions:"",network_type:"",ip:"",screen_pixel:"",screen_size:"",device_class:"",device_brand:"",device_name:"",device_model:"",os_type:"",os_name:"",os_versions:"",browser_name:"",browser_versions:"",session_id:"",channel:"",origin_otherid:"",traffic_source:"",market:"",start_time:"",end_time:"",environment:"",device_id:"",device_idfa:"",device_idfv:"",device_aaid:"",referer:""},Ue=function(){var e,t,n,i,r,o,a=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i="".concat(e,"_isForma=").concat(t);if(e&&qe[i]&&n)return qe[i];var r=new Fe(e).getResult(),o=r.browser,a=r.device,s=r.os,c=o.name,u=void 0===c?"":c,l=o.version,d=(null==l?void 0:l.replace(/(\d+\.\d+)(\.\d+)*/,"$1"))||"",f="".concat(u,"/").concat(d),h=s.name,p=void 0===h?"":h,v=s.version,g=void 0===v?"":v,m="".concat(p,"/").concat(g),b=t?{os:m,osName:p,osVersion:g,bi:f,browser:u,browserVersion:Number.parseInt(d,10)||0,deviceType:a.type||"",deviceCompany:a.vendor||"",deviceModel:a.model||""}:r;return qe[i]=b,b}(navigator.userAgent),s=a.os,c=a.browser,u=c.name,l=c.version,d=s.name,f=s.version,h=(e=navigator.userAgent.toLowerCase(),/(iphone os|midp|rv:1.2.3.4|ucweb|android|windows ce|windows mobile)/i.test(e)?"Phone":/ipad/i.test(e)?"Tablet":"Desktop");return j(j({},Me),{},{os_versions:f,os_name:d,browser_name:u,browser_versions:l,device_class:"Phone"==h?0:"Desktop"==h?1:"Tablet"==h?2:3,network_type:(r="",o=(null===(t=navigator)||void 0===t?void 0:t.connection)||(null===(n=navigator)||void 0===n?void 0:n.mozConnection)||(null===(i=navigator)||void 0===i?void 0:i.webkitConnection),o&&void 0!==(null==o?void 0:o.effectiveType)&&(r=null==o?void 0:o.effectiveType),r),screen_pixel:window.screen.width*(Math.round(window.devicePixelRatio)||1)+"*"+window.screen.height*(Math.round(window.devicePixelRatio)||1),traffic_source:encodeURIComponent(document.referrer)||"",system_language:navigator.language||"",os_type:"Phone"==h?0:"Desktop"==h?1:"Tablet"==h?2:3})},He=function(e,t){var n;switch(t){case"error":n=console.error;break;case"warn":n=console.warn;break;default:n=console.info}"function"==typeof n&&n(e)},We=function(e,t){for(var n=0,i=(t||2)-(e+="").length;n<i;n++)e="0"+e;return e},ze=function(e,t){var n=new Date||t,i="";switch(e){case"xxxx/x/x x:xx:xx":i=n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+n.getHours()+":"+We(n.getMinutes())+":"+We(n.getSeconds());break;case"xxxx/xx/xx xx:xx:xx":i=n.getFullYear()+"/"+We(n.getMonth()+1)+"/"+We(n.getDate())+" "+We(n.getHours())+":"+We(n.getMinutes())+":"+We(n.getSeconds());break;case"xxxx-xx-xx xx:xx:xx":i=n.getFullYear()+"-"+We(n.getMonth()+1)+"-"+We(n.getDate())+" "+We(n.getHours())+":"+We(n.getMinutes())+":"+We(n.getSeconds())}return i},Ke=function(){return Number(Math.random().toString().substr(3,6)+Date.now())},Be=function(e){if("object"!=N(e))return e;try{for(var t in e=JSON.parse(JSON.stringify(e)))if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];switch(N(n)){case"function":delete e[t];break;case"object":e[t]=Be(n);break;case"number":e[t]=String(n)}}return e}catch(i){return e}};function Je(e){try{if(function(e){try{return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)&&btoa(atob(e))===e}catch(t){return!1}}(e))return e;var t=Date.now(),n="|".concat(t,"|"),i=e.split(""),r=Math.floor(Math.random()*(e.length+1));i.splice(r,0,n);var o=i.join("");return btoa(o)}catch(a){return e}}var Ge,Qe,Ve=function(){return R((function e(t){D(this,e),A(this,"config",void 0),A(this,"webviewCommonParams",{}),A(this,"webviewDynamicParams",{}),A(this,"pageEventSharePrams",{}),A(this,"canILog",!1),A(this,"waitQueue",[]),A(this,"count",0),A(this,"publicFields",{}),this.config=t,this.canILog=t.log||!1,this.publicFields=Ue()}),[{key:"register",value:function(e){for(var t in e){var n=e[t];"function"==typeof n?this.webviewDynamicParams[t]=n:this.webviewCommonParams[t]=n}}},{key:"setPvParams",value:function(e,t){var n=t||{},i=n.params,r=I(n,g);switch(e){case"set":var o,a,s=r.start_time||Date.now();this.pageEventSharePrams=j({page_param:i||{},start_time:s,tab_page_id:null!=r&&r.page_name?r.page_name+s:""},r),null===(o=this.config)||void 0===o||null===(o=o.hooks)||void 0===o||null===(a=o.afterSetPageData)||void 0===a||a.call(o,this.getReportPublicFields());break;case"update":for(var c in t)"object"!==N(t[c])?this.pageEventSharePrams[c]=t[c]:this.pageEventSharePrams[c]=j(j({},this.pageEventSharePrams[c]),t[c]);break;case"end":this.pageEventSharePrams.page_param=j(j({},this.pageEventSharePrams.page_param),i),this.pageEventSharePrams=j(j({},this.pageEventSharePrams),{},{end_time:Date.now()},r)}}},{key:"getUnhandledTask",value:(t=O(S().mark((function e(){var t,n,i,r,o;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.waitQueue.length){e.next=13;break}case 2:if(!this.waitQueue.length){e.next=13;break}if(!(n=this.waitQueue.shift())){e.next=11;break}return e.next=7,this.getReportFields(n.fields,n.requestConfig,n.extendInfo);case 7:i=e.sent,r=i.able,o=I(i,m),r&&t.push(j({},o));case 11:e.next=2;break;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getReportFields",value:(e=O(S().mark((function e(t){var n,i,r,o,a,s,c,u,l,d,f,h,p,v,g,m,w,y,_,k,x,P,T,O,C,E,R,D,A=arguments;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=A.length>1&&void 0!==A[1]?A[1]:{},s=A.length>2?A[2]:void 0,c=this.getAllFields(t,s),"defined"===(null==s?void 0:s.from_event)||c.page_name||this.canILog&&He("请检查pv事件是否正常发送，当前事件page_name缺失：".concat(JSON.stringify(t)),"warn"),l=(u=a||{}).send_type,d=u.headers,f=void 0===d?{}:d,h=I(u,b),p=this.config||{},v=p.url,g=p.sm_device_id,m=p.brand,w=void 0===m?"shein":m,y=p.send_type,_=l||y||"fetch",k=c,e.prev=8,e.next=11,this.beforeReportHooks(c,j(j({},s||{}),{},{send_type:_}));case 11:if(void 0===(x=e.sent)){e.next=19;break}if("boolean"!=typeof x){e.next=18;break}if(x){e.next=16;break}return e.abrupt("return",{able:!1});case 16:e.next=19;break;case 18:"object"===N(x)&&(k=x);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),console.error("[@shein-aidc/basis-analytics]",e.t0);case 24:if(k=Be(k),P=["fetch","ajax"].includes(_),T=P?{"DS-ACCESS-TOKEN":"4bc3a2dd3549401b817438eede7e78da","DS-ACCESS-SITE":w}:{access_token:"NHWgg6YpfUlGukgBju2QqwRgzs0QeqQP",ds_access_site:w},O=(null===(n=this.config)||void 0===n?void 0:n.config)||{},C=O.encryptCookieId,null!==(i=k)&&void 0!==i&&i.cookie_id&&(!0!==C&&(T[P?"Client-Cookie-Id":"client_cookie_id"]=k.cookie_id),!1!==C&&(T[P?"x-oest":"x_oest"]=Je(k.cookie_id)),Reflect.deleteProperty(k,"cookie_id")),null!==(r=k)&&void 0!==r&&r.member_id&&(T[P?"Client-Member-Id":"client_member_id"]=k.member_id,Reflect.deleteProperty(k,"member_id")),null!==(o=k)&&void 0!==o&&o.ugid&&(T[P?"Client-Ugid":"client_ugid"]=k.ugid,Reflect.deleteProperty(k,"ugid")),E="string"==typeof v?v:null==v?void 0:v[_],R=j({url:E||"",headers:j(j({SmDeviceId:g||""},T),f),data:k},h),E){e.next=36;break}return this.canILog&&He("缺少上报的地址","error"),e.abrupt("return",{able:!1});case 36:if((D=["fetch","ajax","image","beacon"]).includes(_)){e.next=40;break}return this.canILog&&He("不存在: ".concat(_," 上报类型, 参考").concat(D.join()),"error"),e.abrupt("return",{able:!1});case 40:return e.abrupt("return",{able:!0,sendType:_,reqParams:R,extendInfo:s,requestConfig:a});case 41:case"end":return e.stop()}}),e,this,[[8,21]])}))),function(t){return e.apply(this,arguments)})},{key:"getAllFields",value:function(e,t){var n=this.getReportPublicFields(),i={};"defined"!==(null==t?void 0:t.from_event)&&(e.log_id||(this.count++,i.log_id=function(){var e;if("function"==typeof(null===(e=globalThis.crypto)||void 0===e?void 0:e.randomUUID))return crypto.randomUUID();var t=[];return t.push(Ke().toString(16).slice(0,8)),t.push(Ke().toString(16).slice(0,4)),t.push(Ke().toString(16).slice(0,4)),t.push(Ke().toString(16).slice(0,4)),t.push(Ke().toString(16).slice(0,12)),t.join("-")}(),i.seq=this.count));var r=new Date,o=j(j(j(j({},n),e||{}),i),{},{timestamp:r.getTime(),local_time:ze("xxxx/xx/xx xx:xx:xx",r)});if(Object.keys(this.webviewDynamicParams).length)for(var a in this.webviewDynamicParams)o[a]=this.webviewDynamicParams[a]();return o}},{key:"getReportPublicFields",value:function(){var e=(this.config||{}).brand,t=void 0===e?"shein":e;return j(j(j({},this.publicFields),{},{home_site:t,referer:encodeURIComponent(window.location.href)},this.webviewCommonParams),this.pageEventSharePrams)}},{key:"beforeReportHooks",value:function(e,t){var n=this;return new Promise((function(i){var r;if("function"!=typeof(null===(r=n.config)||void 0===r||null===(r=r.hooks)||void 0===r?void 0:r.beforeReport))return i(void 0);try{var o,a,s;if("AsyncFunction"!==Object.prototype.toString.call(null===(o=n.config)||void 0===o||null===(o=o.hooks)||void 0===o?void 0:o.beforeReport).slice(8,-1))return i(null===(a=n.config)||void 0===a||null===(a=a.hooks)||void 0===a||null===(s=a.beforeReport)||void 0===s?void 0:s.call(a,e,t));var c,u,l=null;null===(c=n.config)||void 0===c||null===(c=c.hooks)||void 0===c||null===(u=c.beforeReport)||void 0===u||u.call(c,e,t).then((function(e){l&&clearTimeout(l),l=null,i(e)})),l=setTimeout((function(){l&&clearTimeout(l),l=null,i(void 0)}),5e3)}catch(d){console.error("[@shein-aidc/basis-analytics]",d),i(void 0)}}))}}]);var e,t}(),$e=function(e){if(!e)return"";try{return JSON.parse(e)}catch(t){return{}}},Xe=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];"function"==typeof e&&e.apply(void 0,n)}catch(r){console.log("[analytics]: runFunction error",r)}},Ye=function(e,t){var n=(Array.isArray(t)?t:[t]).map((function(e){return e.activity_name})).join(",");return"localhost"===location.hostname||location.hostname.startsWith("local-")||!!localStorage.getItem("__sa_debug")?/\?$/.test(e)?e+n:e+"?"+n:e},Ze=function(){return R((function e(){D(this,e)}),[{key:"xhr",value:function(){return void 0!==globalThis.XMLHttpRequest?new XMLHttpRequest:null}},{key:"simpleFetch",value:function(e){if(Xe(e.onRequest,e.data),"function"==typeof fetch)fetch(Ye(e.url,e.data||{})).then((function(t){return Xe(e.onResponse,t.status,e.data),t.status>=200&&t.status<300||304==t.status?t.text():Promise.reject(t)})).then((function(t){Xe(e.success,$e(t))})).catch((function(t){Xe(e.error,t)}));else{var t=this.xhr();if(!t)return!1;t.open(e.type||"GET",Ye(e.url,e.data),!0),(e.success||e.error||e.onResponse)&&(t.onreadystatechange=function(){try{4==t.readyState&&(Xe(e.onResponse,t.status,e.data),t.status>=200&&t.status<300||304==t.status?Xe(e.success,$e(t.responseText)):Xe(e.error,$e(t.responseText)),t.onreadystatechange=null,t.onload=null)}catch(n){t.onreadystatechange=null,t.onload=null}}),t.send(JSON.stringify(e.data))}}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if("function"==typeof fetch){var t=e.type||"GET";e.type||(t=e.data?"POST":"GET");var n={"Content-Type":e.content_type||"application/json"};for(var i in e.headers){var r=e.headers[i];r&&(n[i]=r)}Xe(e.onRequest,e.data),fetch(Ye(e.url,e.data),{method:t,headers:n,body:JSON.stringify(e.data)}).then((function(t){return Xe(e.onResponse,t.status,e.data),t.status>=200&&t.status<300||304==t.status?t.text():Promise.reject(t)})).then((function(t){Xe(e.success,$e(t))})).catch((function(t){Xe(e.error,t)}))}else this.ajax(e)}))},{key:"ajax",value:function(e){e.type||(e.type=e.data?"POST":"GET");var t=this.xhr();if(!t)return!1;t.open(e.type,Ye(e.url,e.data),!0),Xe(e.onRequest,e.data),(e.success||e.error||e.onResponse)&&(t.onreadystatechange=function(){try{4==t.readyState&&(Xe(e.onResponse,t.status,e.data),t.status>=200&&t.status<300||304==t.status?Xe(e.success,$e(t.responseText)):Xe(e.error,$e(t.responseText)),t.onreadystatechange=null,t.onload=null)}catch(n){t.onreadystatechange=null,t.onload=null}}),t.setRequestHeader("Content-Type",e.content_type||"application/json");var n=e.headers;for(var i in n){var r=n[i];r&&t.setRequestHeader(i,r)}t.send(JSON.stringify(e.data))}},{key:"image",value:function(e){var t=e.headers,n=void 0===t?{}:t,i=[];for(var r in n||{}){var o=n[r];o&&i.push("".concat(r,"=").concat("SmDeviceId"==r?encodeURIComponent(o):o))}i.push("content=".concat(encodeURIComponent(JSON.stringify(e.data))));var a=e.url,s="".concat(a).concat(a.indexOf("?")>-1?"&":"?").concat(i.join("&"));e.success||e.error||e.onRequest||e.onResponse||"function"!=typeof Image?this.simpleFetch({url:s,success:e.success,error:e.error}):(new Image).src=s}},{key:"beacon",value:function(e){if(Xe(e.onRequest,e.data),e.onResponse&&console.log("[analytics]: beacon发送不支持onResponse回调"),"object"===("undefined"==typeof navigator?"undefined":N(navigator))&&"function"==typeof navigator.sendBeacon){var t=new FormData;t.append("content",JSON.stringify(e.data));var n=e.headers,i=void 0===n?{}:n;for(var r in i||{}){var o=i[r];o&&t.append(r,o)}navigator.sendBeacon(Ye(e.url,e.data),t)}else console.log("[analytics]: 当前环境不支持beacon发送, 兜底使用img"),this.image(e)}}])}(),et=function(){return R((function e(t,n){D(this,e),A(this,"taskQueue",[]),A(this,"taskTimeout",null),A(this,"fetchFn",null),A(this,"fetchParam",null),A(this,"mergeConfig",null),this.mergeConfig=t.mergeConfig,this.fetchParam=t.baseFetchParams,this.fetchFn=n}),[{key:"mergeToReport",value:function(e){var t,n,i,r=this;if(this.taskQueue.push(e),this.taskQueue.length>=((null===(t=this.mergeConfig)||void 0===t?void 0:t.fillCount)||10))return null===(i=this.fetchFn)||void 0===i||i.call(this,j(j({},this.fetchParam),{},{data:this.taskQueue})),this.taskQueue=[],this.taskTimeout&&clearTimeout(this.taskTimeout),void(this.taskTimeout=null);this.taskTimeout||(this.taskTimeout=setTimeout((function(){var e;null===(e=r.fetchFn)||void 0===e||e.call(r,j(j({},r.fetchParam),{},{data:r.taskQueue})),r.taskQueue=[],clearTimeout(r.taskTimeout),r.taskTimeout=null}),(null===(n=this.mergeConfig)||void 0===n?void 0:n.fillCount)||100))}}])}(),tt=function(){return R((function e(t,n){D(this,e),A(this,"config",void 0),A(this,"wk",null),A(this,"_failWk",null),A(this,"_HTTP_",void 0),A(this,"definePlugins",{}),A(this,"mergeTaskURLMap",{}),this.config=t,this.definePlugins=n,this._HTTP_=new Ze,this.initFailWorker()}),[{key:"report",value:function(e,t,n){var i,r=void 0!==(null==n?void 0:n.worker)?null==n?void 0:n.worker:null===(i=this.config)||void 0===i?void 0:i.worker;this.toReport(e,t,{workerReport:r,mergeConfig:null==n?void 0:n.mergeConfig})}},{key:"workerThreadReport",value:function(e,t,n){var i,r,o=this;if(null===(i=this.definePlugins)||void 0===i||!i.httpWorker||null===(r=this.definePlugins)||void 0===r||!r.httpWorker.length||"undefined"==typeof Worker)return"undefined"!=typeof Worker?He("请先注册worker插件","error"):He("worker 不可用","error"),void this.mainThreadReport(e,t,n);if(!this.wk){var a=new Blob([this.definePlugins.httpWorker[0]()],{type:"application/javascript"});this.wk=new Worker(URL.createObjectURL(a)),this.wk.addEventListener("message",(function(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.code;if(400===n){var i,r=e.data.data,a=r.sendType,s=r.reqParams;He(e.data,"error"),null===(i=o._HTTP_)||void 0===i||i[a](s)}else if(500===n){var c,u=e.data.data,l=u.sendType,d=u.reqParams;!u.options&&(null===(c=o._failWk)||void 0===c||c.postMessage({type:"record",data:{sendType:l,reqParams:d}}))}else if(200===n){var f,h=e.data.data;if(null!=h&&h.primaryKey)null===(f=o._failWk)||void 0===f||f.postMessage({type:"delete",data:h.primaryKey})}}))}this.wk.postMessage({sendType:e,reqParams:t,options:n})}},{key:"mainThreadReport",value:function(e,t,n){var i,r=this,o=!!this._failWk&&"beacon"!=e;null===(i=this._HTTP_)||void 0===i||i[e](j(j({},t),{},{success:o?function(){var e;null!=n&&n.primaryKey&&(null===(e=r._failWk)||void 0===e||e.postMessage({type:"delete",data:n.primaryKey}))}:void 0,error:o?function(){var i;!n&&(null===(i=r._failWk)||void 0===i||i.postMessage({type:"record",data:{sendType:e,reqParams:t}}))}:void 0}))}},{key:"toReport",value:function(e,t,n){var i=this,r=n.workerReport,o=n.mergeConfig;if(o){var a=t.url,s="key_".concat(r?"worker":"");for(var c in o)s+="_".concat(c,"_").concat(o[c]);s+="_".concat(a);var u=t.data,l=I(t,w);this.mergeTaskURLMap[s]||(this.mergeTaskURLMap[s]=new et({mergeConfig:o,baseFetchParams:l},r?function(t){i.workerThreadReport(e,t)}:function(t){i.mainThreadReport(e,t)})),this.mergeTaskURLMap[s].mergeToReport(u)}else r?this.workerThreadReport(e,t):this.mainThreadReport(e,t)}},{key:"initFailWorker",value:function(){var e,t,n=this;if(!this._failWk&&null!==(e=this.definePlugins)&&void 0!==e&&e.failRetryWorker&&null!==(t=this.definePlugins)&&void 0!==t&&t.failRetryWorker.length&&"undefined"!=typeof Worker){var i=this.definePlugins.failRetryWorker[0](),r=i.core,o=i.config,a=new Blob([r],{type:"application/javascript"});this._failWk=new Worker(URL.createObjectURL(a)),this._failWk.postMessage({type:"init",data:o}),this._failWk.postMessage({type:"retry"}),this._failWk.addEventListener("message",(function(e){var t,i=null===(t=e.data)||void 0===t?void 0:t.code;if(400===i)He(e.data,"error");else if(302===i){var r,o=null===(r=e.data)||void 0===r?void 0:r.data,a=o.primaryKey,s=o.value;if(!s)return;var c=s.sendType,u=s.reqParams;n.workerThreadReport(c,u,{primaryKey:a})}}))}}}])}(),nt=function(){return R((function e(){D(this,e),A(this,"canITrack",!1),A(this,"canILog",!1),A(this,"_RP_",void 0),A(this,"_DA_",void 0),A(this,"definePlugins",{}),A(this,"defineInstPlugins",{}),this.asyncImport()}),[{key:"asyncImport",value:function(){var e,t=this;if("undefined"!=typeof window&&window.sheinAnalytic202311){var n=window.sheinAnalytic202311,i=null===(e=window[n])||void 0===e?void 0:e._q;i&&i.length&&i.forEach((function(e){var n=e[0],i=e[1];"function"==typeof t[n]&&t[n].apply(t,x(i))})),window[n]._t=(new Date).getTime(),window[n]=this}}},{key:"usePlugins",value:function(e){var t=this;try{if(!e.length)return;var n=e.filter((function(e){return e.name}));if(n.length!=e.length)return He("存在插件格式不正确，请检查","warn");n.forEach((function(e){t.definePlugins[e.name]||(t.definePlugins[e.name]=[]),e.immediate?e.handle():t.definePlugins[e.name].push(e.handle)}))}catch(i){console.error("[@shein-aidc/basis-analytics]",i)}}},{key:"reportData",value:(t=O(S().mark((function e(t,n,i){var r,o,a,s,c,u,l;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._DA_.getReportFields(t||{},n||{},i);case 3:return r=e.sent,o=r.able,a=r.sendType,s=r.reqParams,o&&(u=(c=n||{}).worker,l=c.mergeConfig,this._RP_.report(a,s,{worker:u,mergeConfig:l})),e.abrupt("return",o);case 11:return e.prev=11,e.t0=e.catch(0),console.error("[@shein-aidc/basis-analytics]",e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,n,i){return t.apply(this,arguments)})},{key:"init",value:function(e){if("undefined"!=typeof window){this.canILog=e.log||!1;var t=e.plugins,n=void 0===t?[]:t,i=I(e,y);this.usePlugins(n),this._DA_=new Ve(i),this._RP_=new tt(i,this.definePlugins),this.canITrack=!0}}},{key:"registerPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"update";if(!this.canITrack)return this.canILog&&He("请先执行init方法","warn");this._DA_.setPvParams(t,e)}},{key:"register",value:function(e){if(!this.canITrack)return this.canILog&&He("请先执行init方法","warn");this._DA_.register(e)}},{key:"trackEvent",value:(e=O(S().mark((function e(t,n,i){var r,o,a,s,c,u,l,d,f,h,p,v,g,m=this;return S().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canITrack){e.next=2;break}return e.abrupt("return",this.canILog&&He("请先执行init方法","warn"));case 2:try{n=JSON.parse(JSON.stringify(n||{}))}catch(b){n={},console.error("[@shein-aidc/basis-analytics]",b)}e.t0=t,e.next="page_view"===e.t0||"page_leave"===e.t0?6:"event"===e.t0?18:"defined"===e.t0?23:25;break;case 6:return o=(r=n||{}).name,a=r.params,s=I(r,_),u=(c=s||{})._page_params,l=c._event_params,this._DA_.setPvParams("page_view"==t?Object.keys(this._DA_.pageEventSharePrams).length?"update":"set":"end",j({page_param:a},u)),e.next=11,this.reportData(j({activity_name:o||t},l),Object.assign("page_leave"==t?{send_type:"beacon"}:{},i||{}),{from_event:t});case 11:if(d=e.sent,"page_view"!=t||!d){e.next=17;break}return e.next=15,this._DA_.getUnhandledTask();case 15:(f=e.sent)&&f.length&&f.forEach((function(e){var t=e.requestConfig||{},n=t.worker,i=t.mergeConfig;m._RP_.report(e.sendType,e.reqParams,{worker:n,mergeConfig:i})}));case 17:return e.abrupt("break",27);case 18:if(p=(h=n||{}).name,v=h.params,g=I(h,k),p){e.next=21;break}return e.abrupt("return",this.canILog&&He("事件名称不能为空"));case 21:return this.reportData(j({activity_name:p,activity_param:v||{}},g),i||{},{from_event:t}),e.abrupt("break",27);case 23:return this.reportData(n||{},i||{},{from_event:"defined"}),e.abrupt("break",27);case 25:return this.canILog&&He("方法名不存在，请阅读文档后使用","error"),e.abrupt("break",27);case 27:case"end":return e.stop()}}),e,this)}))),function(t,n,i){return e.apply(this,arguments)})}]);var e,t}(),it=new nt,rt=function(){return _createClass2((function e(t){_classCallCheck2(this,e),_defineProperty2(this,"config",void 0),_defineProperty2(this,"initConfig",{}),_defineProperty2(this,"_SDK_",void 0),_defineProperty2(this,"gbPageInfo",{}),_defineProperty2(this,"applyFor","pwa"),console.info("[web-sa]: version: ".concat(p)),this._SDK_=it,this.config=t}),[{key:"updatePageInfo",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.gbPageInfo=_objectSpread2(_objectSpread2({},n?{page_id:"",page_name:"",page_param:"",start_time:"",end_time:"",tab_page_id:""}:this.gbPageInfo),t),null!==(e=this.config)&&void 0!==e&&e.multichannel||(window.getSaPageInfo=this.gbPageInfo)}},{key:"saInitAction",value:function(e){this.initConfig=e||{};var t=new v(this._SDK_,this.config).initAction(e||{},{sendAction:this.sendAction.bind(this)}).applyFor;this.applyFor=t,this.updatePageInfo({},!0)}},{key:"sendPageEnter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=this.getPageInfo();this._SDK_.trackEvent("page_view",{name:"page_view",pv_info_type:"update",_page_params:n,_event_params:e},t)}},{key:"sendPageLeave",value:function(e,t){var n=this.getPageInfo(),i=e.end_time||Date.now();"h5"==this.applyFor&&(i=10==String(i).length?Number(i):Number(String(i).substring(0,10))),this._SDK_.trackEvent("page_leave",{name:"page_view",_page_params:n,_event_params:_objectSpread2(_objectSpread2({},e),{},{end_time:i})},t),this.updatePageInfo({end_time:i})}},{key:"sendDefaultEvent",value:function(e,t,n){var i=e||{},r=i.activity_name,o=i.activity_param,a=_objectWithoutProperties2(i,_excluded8);if(window.SaPageInfo){var s={};for(var c in window.SaPageInfo)["page_id","page_name","start_time","end_time"].includes(c)||(s[c]=window.SaPageInfo[c]);Object.keys(s).length&&(this._SDK_.registerPage(s),this.updatePageInfo(s))}(t.merge||t.mergeConfig)&&(n.mergeConfig=t.mergeConfig||{fillCount:10,fillTime:100}),this._SDK_.trackEvent("event",_objectSpread2({name:r,params:o||{}},a),n)}},{key:"defineCb",value:function(e){var t=e.filter((function(e){return"function"==typeof e}));if(t.length)return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t.forEach((function(e){e.apply(void 0,n)}))}}},{key:"setAction",value:function(e,t){var n=t;switch("object"==_typeof2(e)&&(n=e),e){case"init":var i,r;if(!Object.keys(n||{}).length)return void o("web-sa: init 指令参数不应该是空","error");if(Object.keys(this.initConfig).length)return o("web-sa: 请勿重复初始化！！！当前命令并未完成执行！","warn");this.saInitAction(n),null===(i=this.initConfig)||void 0===i||null===(i=i.config)||void 0===i||null===(i=i.hooks)||void 0===i||null===(r=i.onInit)||void 0===r||r.call(i,JSON.parse(JSON.stringify(n)));break;case"setPageData":var a,s,c,u;if(!(n=_objectSpread2(_objectSpread2({},this.getPageInfo()),n)).page_name)return void o("web-sa: setPageData 指令参数 page_name 不能为空","error");var l=(null===(a=n)||void 0===a?void 0:a.start_time)||Date.now();"h5"==this.applyFor&&(l=10==String(l).length?Number(l):Number(String(l).substring(0,10))),n.start_time=l,n.tab_page_id=null!==(s=n)&&void 0!==s&&s.page_name?n.page_name+l:"",this._SDK_.registerPage(n||{},"set"),this.updatePageInfo(n||{},!0),null===(c=this.initConfig)||void 0===c||null===(c=c.config)||void 0===c||null===(c=c.hooks)||void 0===c||null===(u=c.onSetPageData)||void 0===u||u.call(c,n)}}},{key:"sendAction",value:function(e,t,n){var i,r,o,a,s,c,u,l=t||{},d=n||{};"object"==_typeof2(e)&&(l=e,d=t||{});var f="object"==_typeof2(e)&&(null==e?void 0:e._url)||(null===(i=l)||void 0===i?void 0:i._url)||(null===(r=d)||void 0===r?void 0:r._url)||null;l&&l._url&&delete l._url,d&&d._url&&delete d._url;var h={onRequest:this.defineCb([null===(o=d)||void 0===o?void 0:o.onRequest,null===(a=this.initConfig)||void 0===a||null===(a=a.config)||void 0===a||null===(a=a.hooks)||void 0===a?void 0:a.onRequest]),onResponse:this.defineCb([null===(s=d)||void 0===s?void 0:s.onResponse,null===(c=this.initConfig)||void 0===c||null===(c=c.config)||void 0===c||null===(c=c.hooks)||void 0===c?void 0:c.onResponse])};f&&(h.url=f),h.send_type=d.beacon?"beacon":d.image?"image":"pageLeave"!=e?"fetch":"beacon";var p=[{key1:"ds_from_terminal",key2:"Ds-from-terminal",value:this.applyFor}];switch(null!==(u=this.config)&&void 0!==u&&u.multichannel&&p.push({key1:"content_version",key2:"Content-Version",value:"1"}),window.__CLIENT_IPADDR__&&p.push({key1:"client_ipaddr",key2:"Client-Ipaddr",value:window.__CLIENT_IPADDR__}),window.__CLIENT_IPVER__&&p.push({key1:"client_ipver",key2:"Client-Ipver",value:window.__CLIENT_IPVER__}),h.headers=p.reduce((function(e,t){return["image","beacon"].includes(h.send_type)?e[t.key1]=t.value:e[t.key2]=t.value,e}),{}),e){case"pageEnter":this.sendPageEnter(l,h);break;case"pageLeave":this.sendPageLeave(l,h);break;default:this.sendDefaultEvent(l,d,h)}}},{key:"definedAction",value:function(e,t,n){var i,r,o={"Ds-from-terminal":this.applyFor};switch(this.applyFor){case"h5":"sdk_error"===(null==t?void 0:t.error_type)&&(o["X-Report-Source"]="h5-client-monitor");break;case"pwa":case"pc":"script_error"===(null==t?void 0:t.error_type)&&(o["X-Report-Source"]="pc"==this.applyFor?"shein_w":"shein_PWA_new")}var a={url:e,send_type:"fetch",headers:_objectSpread2(_objectSpread2({},o),null==n?void 0:n.headers),onRequest:this.defineCb([null==n?void 0:n.onRequest,null===(i=this.initConfig)||void 0===i||null===(i=i.config)||void 0===i||null===(i=i.hooks)||void 0===i?void 0:i.onRequest]),onResponse:this.defineCb([null==n?void 0:n.onResponse,null===(r=this.initConfig)||void 0===r||null===(r=r.config)||void 0===r||null===(r=r.hooks)||void 0===r?void 0:r.onResponse])};null!=n&&n.jsonArray&&(a.mergeConfig={fillTime:1}),this._SDK_.trackEvent("defined",t,a)}},{key:"getPageInfo",value:function(){return this.gbPageInfo}}])}(),ot=void 0!==window.web_sa_fix||(null===(t=window.sa)||void 0===t?void 0:t._private_load),at=function(e){var t=[st];window.analysisBeforeInterceptor&&window.analysisBeforeInterceptor.forEach((function(e){t.unshift(e)}));for(var n=Promise.resolve(e);t.length;)n=n.then(t.shift());return n},st=function(e){var t=e.data,n=e.reportConfig,i=t||{},r=i.member_id,o=i.cookie_id,a=i.start_time,s=i.local_time,c=i.device_type,u=i.environment,l=n||{},d=l.send_type,f=l.from_event;if(ot){if("defined"==d)return Promise.resolve({data:!1});if(!((o?parseInt(String(o).slice(-8),16)%100:0)>=95))return Promise.resolve({data:!1})}var h={data:t,type:"bi",platform:c,environment:u,member_id:r,cookie:o||"",start_up_timestamp:a,start_up_time:s,is_h5:!0},p="defined"!==f;if(p||!p&&1==(null==t?void 0:t.auto_track)){null!=t&&t.auto_track&&delete t.auto_track;var v=window.localStorage.getItem("autoTrack");if(v)try{!function(e,t,n){try{var i=window.localStorage.getItem("autoReportTepNum")||0;window.localStorage.setItem("autoReportTepNum",String(Number(i)+1));var r=window.gbCommonInfo&&window.gbCommonInfo.langPath||"",o=[window.gbCommonInfo&&window.gbCommonInfo.origin_site||[location.protocol,"//",location.host,r].join(""),"/shein-tep"].join(""),a="".concat(o,"/tep-detect-tob/event/upload");t.referer_expect=encodeURIComponent(window.location.href);var s={cases:e.cases,session:e.tokenId,group_list:e.groupList,raw:t};if(n&&n.beacon&&navigator&&"function"==typeof navigator.sendBeacon){var c=e||{},u=c.cases,l=c.tokenId,d=new FormData;return l&&d.append("session",l),u&&u.length&&u.forEach((function(e){d.append("cases",e)})),d.append("group_list",JSON.stringify(e.groupList)),d.append("raw",JSON.stringify(t)),navigator.sendBeacon(a+"/form",d)}fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}catch(f){console.error(f)}}(JSON.parse(v),JSON.parse(JSON.stringify(t)),{beacon:"beacon"==d})}catch(b){console.log("[web-sa]: ETP校验平台上报失败",b)}}if(p&&["debug","gray"].includes(u)){var g="\\u0068\\u0074\\u0074\\u0070\\u0073\\u003A\\u002F\\u002F\\u0062\\u0075\\u0072\\u0069\\u0065\\u0064\\u002D\\u0061\\u0064\\u006D\\u0069\\u006E\\u002D\\u0061\\u0070\\u0069\\u002D\\u0067\\u0072\\u0061\\u0079\\u0030\\u0033\\u002E\\u0062\\u0069\\u007A\\u002E\\u0073\\u0068\\u0065\\u0069\\u006E\\u0063\\u006F\\u0072\\u0070\\u002E\\u0063\\u006E\\u002F\\u0073\\u0068\\u0065\\u0069\\u006E\\u002F\\u0061\\u006E\\u0061\\u006C\\u0079\\u007A\\u0065".replace(/\\u([\dA-Fa-f]{4})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))}));if("beacon"==d&&navigator&&"function"==typeof navigator.sendBeacon){var m=new Blob([JSON.stringify(h)],{type:"application/json; charset=UTF-8"});return navigator.sendBeacon(g,m)}fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})}return Promise.resolve({data:t,reportConfig:n})},ct=(Ge={multichannel:ot,hooks:{beforeReport:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n){at({data:e,reportConfig:t}).then((function(e){n(e.data)}))}))}}},Qe=new rt(Ge),function(e,t,n,i){try{switch(e){case"set":Qe.setAction(t,n);break;case"get":return Qe.getPageInfo();case"send":Qe.sendAction(t,n,i);break;case"error":case"performance":Qe.definedAction(t,n,i);break;case"wingError":n&&(n.device_type="h5"),Qe.definedAction(t,n,i)}}catch(r){o("sdk-web-fix: ".concat(r),"error")}});if(null!==(n=window.sa)&&void 0!==n&&n._private_load&&console.log("%c 🔥🔥🔥 sa 埋点重复引入，请检查当前页面资源的引入 \n","border-radius: 3px; background:yellow;color:black;font-size:14px"),console.log("%c 🚀🚀新版的SA埋点SDK \n","border-radius: 3px; background:green;color:white;font-size:12px"),ot){var ut,lt;if(null!==(ut=window.web_sa_fix)&&void 0!==ut&&ut.waitingCommands&&(null===(lt=window.web_sa_fix)||void 0===lt||null===(lt=lt.waitingCommands)||void 0===lt?void 0:lt.length)>0)for(var dt=0;dt<window.web_sa_fix.waitingCommands.length;dt++)ct.apply(ct,window.web_sa_fix.waitingCommands[dt]);window.web_sa_fix=ct}else{if(void 0!==window.sa&&window.sa.waitingCommands&&window.sa.waitingCommands.length>0)for(var ft=0;ft<window.sa.waitingCommands.length;ft++)ct.apply(ct,window.sa.waitingCommands[ft]);window.sa=window.sheinAnalysis=ct,window.sa._private_load=!0}}));
