"use strict";(self.webpackChunkSHEIN_W=self.webpackChunkSHEIN_W||[]).push([[32286],{232286:(e,t,n)=>{n.d(t,{zQ:()=>He,Zh:()=>Ge,JB:()=>Ve,p:()=>ze,Fr:()=>de,Xy:()=>Se,Mi:()=>qe,dm:()=>Ke});var i=n(869588),r=n(538353),o=n(665640);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,b(i.key),i)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e,t,n){return(t=b(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=d(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:t+""}var g,m,y,w,x,I,E,k,C,O,S,M,_,A,P,T,D,j,$=function(e){var t;return"undefined"==typeof window?null:{container:e.scrollContainer?e.scrollContainer instanceof HTMLElement?e.scrollContainer:document.querySelector(e.scrollContainer):window,key:[null===(t=e.mask)||void 0===t?void 0:t.map((function(e){return parseFloat(String(e))})).join(""),e.delay,e.exposeRatio,e.observeHide?"obHide":""].join("")}},B={cache:new Map,get:function(e){var t=(this.cache.get(e.container)||[]).find((function(t){return t.key==e.key}));return t?t.instance:null},set:function(e){var t=this.cache.get(e.container)||[];t.find((function(t){return t.key==e.key}))||(t.push({key:e.key,instance:e.instance}),this.cache.set(e.container,t))},del:function(e){if(e.key){var t=this.cache.get(e.container)||[],n=t.findIndex((function(t){return t.key==e.key}));t.splice(n,1),t.length?this.cache.set(e.container,t):this.cache.delete(e.container)}else this.cache.delete(e.container)}},N="da-eid",L="da-rid",R=function(e){if("undefined"==typeof window||!e)return"";if("string"==typeof e)return e;if(e instanceof HTMLElement){var t=e.getAttribute(N);return"[".concat(N,"=").concat(t,"]")}if((0,i.G)(e))return e.target instanceof HTMLElement?{code:(null==e?void 0:e.code)||"",target:R(e.target)}:e;if(e.length){var n=e[0].classList;return Array.prototype.map.call(n,(function(e){return".".concat(e)})).join("")}return""},W=function(e){return"undefined"!=typeof window&&e?e instanceof HTMLElement?[e]:"string"==typeof e?Array.prototype.slice.call(document.querySelectorAll(e)):(0,i.G)(e)?W(e.target):e.length?Array.prototype.slice.call(e):[e]:[]},F=function(){return Number(Math.random().toString().slice(3,6)+(Date.now()+Math.floor(1e3*Math.random()*100))).toString(36)},Q=function(e,t){var n=void 0;switch(e){case"error":n=o.error;break;case"warn":n=o.warn;break;default:n=o.info}"undefined"!=typeof window&&n(t)},H=function(e){if(!e)return{};var t=e.getBoundingClientRect&&e.getBoundingClientRect()||{},n=t.top,i=void 0===n?0:n,r=t.bottom,o=void 0===r?0:r,s=t.right,a=void 0===s?0:s,l=t.left;return{top:i,bottom:o,right:a,left:void 0===l?0:l,height:e.offsetHeight||e.innerHeight,width:e.offsetWidth||e.innerWidth}},V=function(e,t){if(!e||!t)return!1;var n=e,r=t,o=0,s=[0,0,0,0];if((0,i.G)(e)&&(n=e.el,o=e.ratio||0),(0,i.G)(t)&&(r=t.el,t.mask&&Array.isArray(t.mask)&&t.mask.filter((function(e,t){s[t]=parseInt(String(e))}))),!n||!r)return!1;var a=H(n),l=a.top,c=void 0===l?0:l,u=a.left,d=void 0===u?0:u,h=a.right,p=void 0===h?0:h,f=a.bottom,v=void 0===f?0:f,b=a.width,g=void 0===b?0:b,m=a.height,y=void 0===m?0:m;if(0==g||0==y)return!1;var w=H(r),x=w.top,I=void 0===x?0:x,E=w.left,k=void 0===E?0:E,C=w.width,O=void 0===C?0:C,S=w.height,M=void 0===S?0:S,_=O+k-s[1],A=I+M-s[2],P=I+s[0],T=k+s[3];return!(c>=A-y*o||v<=P+y*o)&&!(p<=T+g*o||d>=_-g*o)},J=N,G=function(){return f((function e(t,n){h(this,e),v(this,"initParams",void 0),v(this,"intersectionObFn",void 0),v(this,"listenerEvent",void 0),v(this,"scrollProgress",-1),v(this,"scrollCbFn",[]),v(this,"listenAddScroll",new Map),v(this,"listenMap",new Map),v(this,"scrollContainer",void 0),"undefined"!=typeof window&&(null!=n&&n.fromExpose&&Q("info","scroll event from expose❗️"),this.initParams=n,this.intersectionObFn=t,this.scrollContainer=null!=n&&n.scrollContainer?W(null==n?void 0:n.scrollContainer)[0]:window,this.init())}),[{key:"init",value:function(){var e;this.listenerEvent=this.createListener(this.handelScrollEvent).bind(this),null===(e=this.scrollContainer)||void 0===e||e.addEventListener("scroll",this.listenerEvent,!1)}},{key:"createListener",value:function(e,t){return void 0===e?function(){}:t&&t>0?(0,r.n)({func:e,wait:t,options:{trailing:!1}}):e}},{key:"handelScrollEvent",value:function(e){this.listenScroll(e),"function"==typeof this.intersectionObFn&&this.listenMap.size&&this.listenerEl()}},{key:"listenerEl",value:function(){var e,t=this,n=[];this.listenMap.forEach((function(e){var i=t._withInArea(e.target);e.isIntersecting!==i&&(t.listenMap.set(e.id,Object.assign(e,{isIntersecting:i})),n.push({isIntersecting:i,target:e.target}))})),n.length&&(null===(e=this.intersectionObFn)||void 0===e||e.call(this,n))}},{key:"_withInArea",value:function(e){var t,n;return V({el:e,ratio:(null===(t=this.initParams)||void 0===t?void 0:t.exposeRatio)||0},{el:this.scrollContainer||window,mask:(null===(n=this.initParams)||void 0===n?void 0:n.mask)||[0,0,0,0]})}},{key:"listenScroll",value:function(e){if(this.scrollCbFn.length){var t=this.scrollContainer===window?Math.abs(H(document.body).top||0):this.scrollContainer.scrollTop||0,n=t-this.scrollProgress;if(0!==n){var i={scrollTop:t,type:n>0?"down":"up"};this.scrollProgress=t,this.scrollCbFn.forEach((function(t){return t(i,e)}))}}}},{key:"listen",value:function(e,t){if("function"==typeof e){var n=F(),i=this.createListener(e,null==t?void 0:t.delay);return this.listenAddScroll.set(n,i),this.scrollCbFn.push(i),n}}},{key:"unListen",value:function(e){if(e&&this.listenAddScroll.has(e)){this.listenAddScroll.delete(e);var t=[];this.listenAddScroll.forEach((function(e){t.push(e)})),this.scrollCbFn=t}}},{key:"observe",value:function(e){if(e){var t=e.getAttribute(J);t&&this.listenMap.has(t)||(t||(t=F(),e.setAttribute(J,t)),this.listenMap.set(t,{id:t,isIntersecting:!1,target:e}))}}},{key:"unobserve",value:function(e){if(e){var t=e.getAttribute(J);t&&this.listenMap.delete(t)}}},{key:"disconnect",value:function(){var e;this.listenerEvent&&(null===(e=this.scrollContainer)||void 0===e||e.removeEventListener("scroll",this.listenerEvent,!1))}}])}(),q=function(){return f((function e(t,n){h(this,e),v(this,"evt",null),v(this,"initOption",void 0),v(this,"handleExposeEvent",[]),v(this,"scrollContainer",void 0),v(this,"io",null),this.initOption=t||null,"undefined"!=typeof window&&(this.scrollContainer=null!=t&&t.scrollContainer?W(null==t?void 0:t.scrollContainer)[0]:null,this.init(n))}),[{key:"init",value:function(e){if(this.evt=function(e,t){if("function"==typeof window.CustomEvent)return new CustomEvent(e,t);t=t||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}("scroll",{bubbles:!1,cancelable:!1}),window.hasOwnProperty("IntersectionObserver")){var t,n,i=(null===(t=this.initOption)||void 0===t||null===(t=t.mask)||void 0===t?void 0:t.map((function(e){return"".concat(-(parseInt(String(e))||0),"px")})).join(" "))||"0px 0px 0px 0px";this.io=new IntersectionObserver(e,{root:this.scrollContainer||null,rootMargin:i,threshold:[(null===(n=this.initOption)||void 0===n?void 0:n.exposeRatio)||0]}),this.scrollContainer=this.scrollContainer||window}else{var r,o,s=this.scrollContainer||window;this.scrollContainer=s,this.io=new G(e,{scrollContainer:s,exposeRatio:(null===(r=this.initOption)||void 0===r?void 0:r.exposeRatio)||0,mask:null===(o=this.initOption)||void 0===o?void 0:o.mask})}}},{key:"triggerScroll",value:function(){var e=this;(0,r.n)({func:function(){var t;null===(t=e.scrollContainer)||void 0===t||t.dispatchEvent(e.evt)},wait:300,options:{trailing:!1}})}},{key:"destroy",value:function(){var e;null===(e=this.io)||void 0===e||e.disconnect()}}])}(),z=N,K=L,U=function(){return f((function e(t){h(this,e),v(this,"hasBeenExposeId",new Map),v(this,"initParams",void 0),v(this,"scrollInstance",null),v(this,"singleBlockObMap",new Map),v(this,"intersectionIoMap",new Map),v(this,"intersectionTempExpose",new Set),v(this,"timer",void 0),v(this,"logFn",(function(){})),this.initParams=t,void 0!==("undefined"==typeof window?"undefined":d(window))&&this.init(t)}),[{key:"init",value:function(e){this.scrollInstance=new q({scrollContainer:null==e?void 0:e.scrollContainer,exposeRatio:null==e?void 0:e.exposeRatio,delay:null==e?void 0:e.delay,mask:null==e?void 0:e.mask},this.intersectionObserverCallback.bind(this)),this.logFn=null!=e&&e.log?Q:function(){}}},{key:"intersectionObserverCallback",value:function(e){var t=this;e.forEach((function(e){var n=e.target;if(e.isIntersecting){var i=(t.initParams||{}).delay,r=void 0===i?1e3:i;t.intersectionTempExpose.add(n),clearTimeout(t.timer),t.timer=setTimeout((function(){t.intersectionPreExpose(l(t.intersectionTempExpose)),t.intersectionTempExpose.clear()}),r)}else{var o;null!==(o=t.initParams)&&void 0!==o&&o.observeHide&&t.sendHideEvent(n)}}))}},{key:"intersectionPreExpose",value:function(e){var t=this;if(e.length){var n={};for(var i in e.forEach((function(e){if(t._withInArea(e)){var i=e.getAttribute(z),r=t.intersectionIoMap.get(i);r&&(n[r.code]||(n[r.code]={info:r,exposeDoms:[]}),n[r.code].exposeDoms.push(e))}})),n){var r=n[i];r.exposeDoms.length&&this.sendExposeEvent(r.info,r.exposeDoms)}}}},{key:"sendHideEvent",value:function(e){if(e){var t=e.getAttribute(z),n=this.intersectionIoMap.get(t);if(n){var i=n.code;(0,n.handle)({code:i,exposeDoms:[],hideDoms:[e]})}}}},{key:"sendExposeEvent",value:function(e,t){var n=this,i=e.code,r=e.once,o=e.handle,s=e.middleJudge,a=t.filter((function(e){var t=n.hasBeenExposeId.get(i)||new Set,o=e.getAttribute(z)||"",a=e.getAttribute(K)||"",l=a?t.has(a):t.has(o);if(l)r&&n.removeElements([e]);else{if("function"==typeof s&&!s(e,i))return!1;r&&(t.add(o),a&&t.add(a),n.hasBeenExposeId.set(i,t),n.removeElements([e]))}return!l}));a.length&&o({code:i,hideDoms:[],exposeDoms:a})}},{key:"_withInArea",value:function(e){var t,n,i;return V({el:e,ratio:(null===(t=this.initParams)||void 0===t?void 0:t.exposeRatio)||0},{el:null===(n=this.scrollInstance)||void 0===n?void 0:n.scrollContainer,mask:(null===(i=this.initParams)||void 0===i?void 0:i.mask)||[0,0,0,0]})}},{key:"addEleObId",value:function(e){return e.filter((function(e){if(e&&1==e.nodeType){if(!e.getAttribute(z)){var t=F();e.setAttribute(z,t)}return!0}}))}},{key:"singleBlock",value:function(e,t){var n=this,i=e.elements,r=(null==e?void 0:e.code)||(null==i?void 0:i.code)||"".concat(F(),"_code"),o={code:r,handle:t,once:void 0===e.once||e.once,middleJudge:null==e?void 0:e.middleJudge,elements:"",ids:new Set},s=this.addEleObId(W(i));if(s.length){var a=this.hasBeenExposeId.get(o.code);if(!(s=s.filter((function(e){var t=e.getAttribute(z)||"";return!(a&&a.has(t)||n.intersectionIoMap.has(t))}))).length)return this.logFn("warn","[basis-expose]: 未查询到元素，请检查元素是否[已曝光｜未创建]");o.elements=R(i),this.singleBlockObMap.has(r)||this.singleBlockObMap.set(r,Object.assign({},o));var l=s.map((function(e){return null==e?void 0:e.getAttribute(z)})).filter((function(e){return!!e})),c=this.singleBlockObMap.get(r)||{};l.forEach((function(e){c.ids.add(e)})),this.singleBlockObMap.set(r,c),this.addToIntersectionOb(s,Object.assign({},o,{ids:null}))}}},{key:"multiBlock",value:function(e,t){var n=this,i=e.section;if(!i||!i.length)return this.logFn("warn","[basis-expose]: multiBlock - 请传入正确的 section 格式");i.filter((function(e){return!!e.target})).forEach((function(i){var r=i.container,o=i.content,s=i.target,l=i.code||"".concat(F(),"_code"),c=[r,o,s].filter((function(e){return!!e})).join(" ");n.singleBlock(a(a({},e),{},{elements:{code:l,target:c}}),t)}))}},{key:"addToIntersectionOb",value:function(e,t){var n=this;e.forEach((function(e){var i,r=e.getAttribute(z);if(!n.intersectionIoMap.has(r)){var o=e.getAttribute(K);if(t.code&&o){var s=n.hasBeenExposeId.get(t.code);if(s&&s.has(o))return}n.intersectionIoMap.set(r,t),null===(i=n.scrollInstance)||void 0===i||i.io.observe(e)}}))}},{key:"removeElements",value:function(e){if(!e||!e.length)return this.logFn("warn","[basis-expose]: removeElements - 元素应该给数组类型");var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(e);try{for(n.s();!(t=n.n()).done;){var i,r,o,s,a=t.value;null===(i=this.scrollInstance)||void 0===i||i.io.unobserve(a);var l=a.getAttribute(z),u=this.intersectionIoMap.get(l),d=this.singleBlockObMap.get(u.code);null==d||null===(r=d.ids)||void 0===r||null===(o=(s=r).delete)||void 0===o||o.call(s,l),this.intersectionIoMap.delete(l)}}catch(e){n.e(e)}finally{n.f()}}},{key:"observe",value:function(e,t){var n=this;if(e){var i=e.elements,r=e.section;i||r?(i&&(Array.isArray(i)?i.forEach((function(i){n.singleBlock(a(a({},e),{},{elements:i}),t)})):this.singleBlock(e,t)),r&&r.length&&this.multiBlock(e,t),this.triggerScroll()):this.logFn("info","[basis-expose]: observe - 缺少元素|选择器")}}},{key:"update",value:function(e){var t=this;if(!e)return this.logFn("warn","[basis-expose]: update - 方法缺少code");e.split(",").forEach((function(e){var n=t.singleBlockObMap.get(e);if(n){var i=n.handle;t.singleBlock(n,i)}})),this.triggerScroll()}},{key:"remove",value:function(e){var t=this;if(!e)return this.logFn("warn","[basis-expose]: remove - 方法缺少code");e.split(",").forEach((function(e){var n=t.singleBlockObMap.get(e);if(n){var i=n.ids;(null==i?void 0:i.size)>0&&i.forEach((function(e){t.intersectionIoMap.delete(e)})),t.singleBlockObMap.delete(e)}t.hasBeenExposeId.delete(e)}))}},{key:"reset",value:function(e){var t=this;if(!e)return this.logFn("warn","[basis-expose]: reset - 方法缺少code");var n=this.hasBeenExposeId.get(e);n&&(this.hasBeenExposeId.delete(e),l(n).forEach((function(n){var i=W("[".concat(z,'="').concat(n,'"]'));if(i){var r=t.singleBlockObMap.get(e);r&&t.singleBlock(a(a({},r),{},{elements:{code:e,target:i}}),r.handle)}})),this.triggerScroll())}},{key:"resetAll",value:function(e){var t=this;if(this.hasBeenExposeId.size>0){var n,i,r=l(this.hasBeenExposeId);if(e)"function"==typeof e&&(r=e(r)),"string"==typeof e&&(r=null===(n=r)||void 0===n||null===(i=n.filter)||void 0===i?void 0:i.call(n,(function(t){return!!t.length&&t[0].startsWith(e)})));r.map((function(e){return e[0]})).forEach((function(e){t.reset(e)}))}}},{key:"destroy",value:function(){var e;null===(e=this.scrollInstance)||void 0===e||e.destroy();var t=$(this.initParams||{});t&&B.del(t)}},{key:"triggerScroll",value:function(){var e;null===(e=this.scrollInstance)||void 0===e||e.triggerScroll()}}])}(),X=n(665640),Z=Object.defineProperty,Y=(e,t,n)=>(((e,t,n)=>{t in e?Z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),ee=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},te=(e,t,n)=>(ee(e,t,"read from private field"),n?n.call(e):t.get(e)),ne=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},ie=(e,t,n,i)=>(ee(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),re=(e,t,n)=>(ee(e,t,"access private method"),n);const oe=new Map,se={get:e=>oe.get(e),has:e=>oe.has(e),set:(e,t)=>(oe.set(e,t),oe),delete(e){oe.delete(e)}},ae="[sa-event-center]";let le="error";const ce={all:0,debug:10,info:20,warning:30,error:40,off:50},ue=new Proxy(X,{get(e,t,n){if("setLevel"===t)return e=>{le=e};if(!Reflect.has(e,t))return()=>{};const i=Reflect.get(e,t,n);return(...n)=>{if(!(ce[t]<ce[le]))return i.apply(e,[ae,...n].concat([]))}}});ue.setLevel("info");const de=function(e){return e&&/^[12](-\d+){2,4}$/.test(e)},he=function(e){if(!e||de(e))return e;if(e.indexOf("：")>=0)throw new Error("please use english colon.");let[t,n]=e.split(/:/),[i,r,o]=t.split(".");return n=n||"",{evName:i?i.trim():"",pageName:(r||"common").trim(),eId:(o||"").trim(),evSegment:[i,r,o].filter((e=>e&&e.trim())).join("."),modifiers:n.split(".").filter((e=>e&&e.trim()))}};function pe(e=0){const t=this;return function(n,...i){const r=()=>{if(!n||"function"!=typeof n)return;n.bind(t,...i)()};e?setTimeout(r,e):r()}}function fe(){return fe.prefix+"_"+ ++fe.start}function ve(e,t){return t=t||3,"undefined"==typeof window?{}:3==+t?e:{inserted:e.mounted,componentUpdated:e.updated,unbind:e.unmounted}}fe.start=fe.start||0,fe.prefix=Number(Math.random().toString().slice(3,6)+Date.now()).toString(36);const be=e=>{const t=e.value;return!t||!t.id},ge=e=>({set:(t,n)=>(t[e]=n,n),get:t=>t?t[e]:t,updateBindValue(e,t){const n=this.get(e);return n?se.set(n,t.value):null},getBindValue(e){const t=this.get(e);return t?se.get(t):null},clear(e){const t=this.get(e);if(!t)return null;setTimeout((()=>{se.delete(t)}),"PWA"!==("undefined"==typeof window?"":(window.gbCommonInfo||{PLATFORM:""}).PLATFORM||"")?0:1100)}});function me(e,t){const n=he(e);return n&&"object"==typeof n&&t?e+(n.eId?"_":".")+t:e}const ye=e=>`${e}_${fe()}`;class we{constructor(){this.subscriber={},this.unSendEvent={},this.has=Object.prototype.hasOwnProperty}publish({target:e=null,daId:t=null,bindData:n=null,sendType:i="event",extraData:r={},parsed:o={}}={}){t&&(this.has.call(this.subscriber,t)?de(t)?this.subscriber[t].sendType.includes(i)&&this.subscriber[t].handler({target:e,extraData:r,bindData:n}):this.subscriber[t]&&this.subscriber[t]({target:e,extraData:r,bindData:n,parsed:o}):this.pushEventInQueue({target:e,daId:t,sendType:i,extraData:r,bindData:n}))}subscribe({daId:e=null,handler:t=null,sendType:n=!1}={}){if(e&&t&&!this.has.call(this.subscriber,e)){if(de(e))return this.subscriber[e]={sendType:n,handler:t},void this.executeEventInQueue({daId:e,handler:t,sendType:n});this.subscriber[e]=t,this.executeEventInQueue({daId:e,handler:t})}}unsubscribe(e){e.forEach((e=>{this.subscriber.hasOwnProperty(e)&&delete this.subscriber[e]}))}pushEventInQueue({target:e=null,daId:t=null,sendType:n="event",bindData:i=null,extraData:r={}}={}){this.has.call(this.unSendEvent,t)||(this.unSendEvent[t]=[]),this.unSendEvent[t].push({target:e,daId:t,sendType:n,bindData:i,extraData:r})}executeEventInQueue({daId:e=null,handler:t=null,sendType:n=[]}={}){if(!this.has.call(this.unSendEvent,e)||this.unSendEvent[e].length<=0)return;let i=this.unSendEvent[e].length;for(;i>0;){let r=this.unSendEvent[e].shift();n.includes(r.sendType)&&t&&t({target:r.target,extraData:r.extraData,bindData:r.bindData}),--i}}}class xe{constructor({controlCenter:e=null}={}){this.controlCenter=e}notify({target:e=null,daId:t=null,sendType:n="event",bindData:i=null,extraData:r={},parsed:o={}}={}){t&&this.controlCenter.publish({target:e,daId:t,sendType:n,extraData:r,bindData:i,parsed:o})}}const Ie=(e,t)=>e?t.reduce(((t,n)=>(Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]),t)),{}):{},Ee=(e,t)=>e?t&&0!==t.length?t.reduce(((e,t)=>(delete e[t],e)),{...e}):e:{},ke="undefined"!=typeof window?window:{};ke.G_SA_TRACK=ke.G_SA_TRACK||{};const Ce=()=>{};let Oe={v2:Ce,getMapping:null,legacyAbcd:{addSubscriber:Ce,triggerNotice:Ce,getExposeInstance:Ce,importAbcdCode:Ce}};function Se(e){if("undefined"!=typeof window)return ke.G_SA_TRACK.__asyncImports?(X.warn("value has been assigned."),!1):(Oe=ke.G_SA_TRACK.__asyncImports=e,!0)}const Me=new Proxy({},{get:(e,t)=>{const n=ke.G_SA_TRACK.__asyncImports;return Oe.hasOwnProperty(t)?(n||Oe)[t]:null}});let _e=!1;const Ae={pc:"she_dist",h5:"sh5_dist",pwa:"pwa_dist"};if("undefined"!=typeof window&&"undefined"!=typeof gbCommonInfo){const{PUBLIC_CDN:e="",PLATFORM:t="PC"}=gbCommonInfo;window.__webpack_public_path__=`${e}/${Ae[t.toLowerCase()]}/assets/`}"undefined"!=typeof window&&(_e=!0);const Pe=async e=>{if(!e||"string"!=typeof e)return Promise.resolve();let t=e.split("-")||[],n=[];try{let e=t[0]||"0";if(!aTagMap[e])throw new Error(`aTag: ${e} undefined from aTagMap: ${JSON.stringify(aTagMap)}`);n.push(aTagMap[e]);let i=t[1]||"0";if(!bTagMap[`${e}-${i}`])throw new Error(`bTag: ${e}-${i} undefined from bTagMap: ${JSON.stringify(bTagMap)}`);if(n.push(bTagMap[`${e}-${i}`]),"1"===e){let r=t[2]||"0";if(!cTagMap[`${e}-${i}-${r}`])throw new Error(`cTag: ${e}-${i}-${r} undefined from cTabMap: ${JSON.stringify(cTagMap)}`);n.push(cTagMap[`${e}-${i}-${r}`])}return Me.legacyAbcd.importAbcdCode(`${n.join("/")}`)}catch(e){return X.error(e),Promise.resolve()}},Te=Object.create(null);let De=null;let je={subscribeLoadQueue:[],executeSubscribeRequireInQueue(){for(;this.subscribeLoadQueue.length>0;){let{resolve:e,modulecode:t}=this.subscribeLoadQueue.shift();e(Pe({modulecode:t}))}},require({modCode:e}={}){return e?_e?de(e)?Pe(e):/^(page_|comp_|common)/.test(e)?(async(e,t)=>{De||(De=Me.getMapping());try{const n=De[e||"common"];if(t){const e=n[t];return Me.v2(e)}if(Te[e]||!n)return{default:null};const i=[...new Set(Object.values(n))],r=(await Promise.allSettled(i.map((async e=>{try{return(await Me.v2(e)).default}catch(e){return X.error(e),{default:null}}})))).reduce(((e,t)=>"fulfilled"===t.status?{...e,...t.value}:e),{});return Te[e]=r,{default:r}}catch(e){return X.error(e),{default:null}}})(e):Promise.resolve():new Promise(((t,n)=>{this.subscribeLoadQueue.push({resolve:t,reject:n,modCode:e})})):Promise.resolve()}};var $e={report({sa:e=null}={}){e&&this._sendSa(e)},_sendSa({name:e=null,param:t=null,beacon:n=!1,image:i=!1,page_param:r=null,page_name:o="",page_id:s="",tab_page_id:a=""}={}){if(!e)return;if("undefined"==typeof sa)return void X.error(`shein-sa is not exist when sending ${[e,JSON.stringify(t)]}`);const l={};s&&(l.page_id=s),o&&(l.page_name=o),a&&(l.tab_page_id=a),r&&(l.page_param=r),ue.debug(e,"start report data"),sa("send",{...l,activity_name:e,activity_param:t||{}},{beacon:n?1:0,image:i?1:0})}};class Be{constructor({controlCenter:e=null}={}){this.controlCenter=e,this.analysis=je,this.loadedPageNames={}}subscribe({modCode:e=null}={}){return/^(page_|comp_|common)/.test(e=e||"common")&&this.loadedPageNames[e]?Promise.resolve({}):this.analysis.require({modCode:e}).then((({default:t}={})=>{if(!t)return{};if(/^(page_|comp_|common)/.test(e)){if(this.loadedPageNames[e])return;this.loadedPageNames[e]=t}return Object.entries(t).forEach((e=>{const n=e[0];de(n)?this._orgNumMapSub(e[0],e[1],t):this.subNewDirectMap(e[0],e[1])})),t}))}_orgNumMapSub(e,t,n){let{sa:i,ga:r,sendType:o,handler:s}=t;const a=i?JSON.parse(JSON.stringify(i)):void 0,l=r?JSON.parse(JSON.stringify(r)):void 0,c=s?s.bind(n,{sa:a,ga:l,report:$e.report.bind($e)}):$e.report.bind($e,{sa:a,ga:l});this.controlCenter.subscribe({daId:e,handler:c,sendType:o})}_getMergeParamObj({target:e,extraData:t={},bindData:n={}},i){const{modifiers:r=[]}=i,o=/^expose_/.test(i.evName)&&r.includes("list"),s=(Array.isArray(e)?e:e?[e]:[]).map((e=>e.dataset||null));return{mergeParams:{..."[object Object]"===Object.prototype.toString.call(n)?n:Array.isArray(n)?o?{bindData:n}:n[0]:n,...t},source:{extraData:t,bindData:n,dataset:o?s:s[0]}}}subNewDirectMap(e,t){t=t||(e=>e.extraData);this.controlCenter.subscribe({daId:e,handler:async({target:e,extraData:n,bindData:i,parsed:r})=>{const o=e=>{o._called=!0,$e.report({sa:e})},s=this._getMergeParamObj({target:e,extraData:n,bindData:i},r);let a=t({extraData:s.mergeParams,source:s.source,target:e,name:r.evName,parsed:r,report:o},{pick:Ie,omit:Ee,select(e){return Ie(1===arguments.length?n:arguments[1],e)}});if(void 0===a||!1===a||["number","string"].includes(typeof a))return!1;for(a=a||{};a&&"function"==typeof a.then;)a=await a;const l=Object.prototype.toString.call(a).slice(8,-1);return!!o._called||(o._called||["Object","Null"].includes(l)?void this.reportWithParams(r.evName,a||{},r):(X.error(`The return value of track function is ${l}, should be an object.`),!1))}})}directlyReport(e,t){const n=he(e),i=this._getMergeParamObj(t,n);this.reportWithParams(n.evName,i.mergeParams,n)}reportWithParams(e,t,n){const{$options:i}=t||{},{modifiers:r=[]}=n;t&&Object.keys(t).forEach((e=>{e.startsWith("$")&&delete t[e]})),$e.report({sa:{name:e,param:t||{},image:!!(null==i?void 0:i.send_img),beacon:!!(null==i?void 0:i.send_beacon)||r.includes("beacon"),...i}})}}class Ne{constructor({controlCenter:e=null,publisher:t=null,subscriber:n=null}){this.controlCenter=e,this.publisher=t,this.subscriber=n,this.eventAttributeMap={click:"da-event-click",touchstart:"da-event-touchstart",focus:"da-event-focus",blur:"da-event-blur"},this._bindEvent({event:"click",attribute:this.eventAttributeMap.click}),this._bindEvent({event:"touchstart",attribute:this.eventAttributeMap.touchstart}),this._bindEvent({event:"focus",attribute:this.eventAttributeMap.focus,useCapture:!0}),this._bindEvent({event:"blur",attribute:this.eventAttributeMap.blur,useCapture:!0})}_bindEvent({event:e="",attribute:t="",useCapture:n=!1}={}){"undefined"!=typeof document&&document&&document.addEventListener(e,(e=>{var n;if(!t||document===e.target)return;const i=null==(n=e.target)?void 0:n.closest(`[${t}]`);if(!i)return;let r=i.getAttribute(t);this.publisher.notify({daId:r,sendType:"event",target:i})}),n)}bindEventByDaId({event:e="",daId:t=""}={}){document.querySelectorAll(`[${this.eventAttributeMap[e]}="${t}"]`).forEach((n=>{n.addEventListener(e,(e=>{this.publisher.notify({daId:t,sendType:"event",target:e.currentTarget})}))}))}}const Le=new Map,Re=({code:e})=>{const t=location.pathname;if(Le.has(t)){Le.get(t).add(e)}else Le.set(t,new Set([e]));return Le};class We{constructor({publisher:e,context:t,...n}){this.exposeInst=new U(n),this.publisher=e,this.context=t,this.pendingQueue=[],this.isConsumingPending=!1,this.domInfo={loaded:"loading"!==document.readyState},window.addEventListener("DOMContentLoaded",(()=>{this.domInfo.loaded=!0,this.consumePending()}))}async subscribe({keycode:e="",type:t="",horizontal:n=!1,once:i=!0,middleJudge:r=null,hooks:o={}}){const s=e.split(",");if(!s.length)return;if(!this.checkDocLoad("subscribe",arguments))return;let a=[],l=[];s.forEach((e=>{const i=e.split("`");if(!i[0])return X.warn(`da expose: [${e}] missing subscribe code`);if(i.length<=1)return X.warn(`da expose: subscriber code [${i[0]}] missing expose id`);const r=i[1].split("|").map((e=>`[da-event-expose='${e}']`));"PWA"===gbCommonInfo.PLATFORM&&Re({code:i[0]}),"list"===t?a.push({code:i[0],container:`[da-expose-code=${i[0]}]`,target:r.join(),averageContent:!1,horizontal:n}):l.push({code:i[0],target:r.map((e=>`[da-expose-code=${i[0]}] ${e}`)).join()})})),(a.length||l.length)&&this.exposeInst.observe({section:a,elements:l,middleJudge:r,once:i},(({exposeDoms:e})=>{let t={};e.forEach((e=>{if(!e)return;const n=e.getAttribute("da-event-expose");let i=t[n]||[];i.push(e),t[n]=i}));for(const e in t){const n=t[e];(null==o?void 0:o.afterExpose)&&"function"==typeof o.afterExpose&&o.afterExpose({targets:n,daId:e}),this.context.triggerNotice({daId:e,sendType:"event",target:n})}}))}async directiveSubscribe(e,t,n){const{getBindInfo:i}=n;this.checkDocLoad("directiveSubscribe",arguments)&&this.exposeInst.observe(t,(({exposeDoms:t})=>{let r={};t.forEach((t=>{var n;if(!t)return;let o=r[e]||{doms:[],binding:[]};o.doms.push(t),o.binding.push((null==(n=i(t))?void 0:n.data)||null),r[e]=o}));for(const e in r){const t=r[e];(null==n?void 0:n.afterExpose)&&"function"==typeof n.afterExpose&&n.afterExpose({targets:t.doms,daId:e}),this.context.triggerNotice({daId:e,sendType:"event",target:t.doms,bindData:t.binding})}}))}reset(e){this.exposeInst.reset(e)}resetAll(e){this.exposeInst.resetAll(e)}triggerScroll(){this.exposeInst.triggerScroll()}update(e){this.exposeInst.update(e)}destroy(){var e;null==(e=this.exposeInst)||e.destroy()}remove(e){var t;null==(t=this.exposeInst)||t.remove(e)}checkDocLoad(e,t){return this.domInfo.loaded?(this.domInfo.loaded&&0===this.pendingQueue.length||this.consumePending(),!0):(this.pendingQueue.push([e,t]),!1)}consumePending(){if(this.isConsumingPending)return!0;this.isConsumingPending=!0,this.pendingQueue.length>0&&(this.pendingQueue.forEach((([e,t])=>{this[e]&&this[e].apply(this,t)})),this.pendingQueue=[])}}const Fe=function(e){var t=$(e||{});if(t){var n=B.get(t);if(n)return n}var i=new U(e);return t&&B.set(Object.assign(t,{instance:i})),i}();let Qe=null;"undefined"!=typeof window&&(window.windowScrollInstance=Fe,Qe=new G);class He{constructor(e=""){let t=null;t="string"==typeof e?{mode:"runtime"===e?"runtime":"initial"}:e||{mode:"runtime"},this.options=t,this.controlCenter=new we,this.publisher=new xe({controlCenter:this.controlCenter}),this.subscriber=new Be({controlCenter:this.controlCenter}),this.event=new Ne({controlCenter:this.controlCenter,publisher:this.publisher,subscriber:this.subscriber}),this.scrollInstance=this.getExposeInstance(),this.__instInfo={mode:t.mode,version:"0.1.38"}}addSubscriber(e){const t=[];if("string"==typeof e)t.push(e);else if(Array.isArray(e))t.push(...e);else if("object"==typeof e){const n=e.modCode||e.modulecode;n&&t.push(n)}const n=t.filter(Boolean).map((e=>de(e)?Me.legacyAbcd?Me.legacyAbcd.addSubscriber({modulecode:e}):null:this.subscriber.subscribe({modCode:e})));return Promise.allSettled(n).then((e=>!0))}addSubscriberObject(e){const t=Object.keys(e),n=[];for(let r of t){const t=e[r];t&&"function"==typeof t?(i=r)&&/^\w+(?:\.(page_|comp_)[\w-]+(?:\.[\w-]+)?)?$/.test(i)?(n.push(r),this.subscriber.subNewDirectMap(r,t)):ue.warn(`event: ${r} is invalid, only support v2 like event_name.page_name:modifiers.`):ue.warn(`invalid ${r} or handler.`)}var i;return()=>new Promise((e=>{setTimeout((()=>{this.controlCenter.unsubscribe(n),e()}),0)}))}async triggerNotice({target:e,daIdTag:t="",daId:n="",id:i,sendType:r="user",bindData:o=null,extraData:s=null,data:a=null}={},l=0){if(s=s||a||{},!(n=n||i||""))return;const c=Array.prototype.slice.call(arguments);c[0].daId=c[0].id=n,c[0].extraData=c[0].data=s,ue.debug(n,"trigger event");const u=pe.call(this,l);if(t&&!e){const i=document.querySelectorAll(`[${t}="${n}"]`);e=i&&i.length>0&&i[0]}if(de(n))return c[0].from_v2_proxy=!0,Me.legacyAbcd.triggerNotice(...c),!0;let d=he(n);const{evName:h,pageName:p,eId:f,modifiers:v,evSegment:b}=d;if(!h)return ue.error("event name should be not empty"),!1;if(v.includes("simple"))return this.subscriber.directlyReport(n,{target:e,extraData:s,bindData:o}),!0;const g="runtime"===this.options.mode;g&&!this.subscriber.loadedPageNames[p]&&"function"==typeof Me.getMapping&&(ue.debug(n,"pull config begin"),await this.addSubscriber({modCode:p}),ue.debug(n,"pull config end"));if(!f&&!this.controlCenter.subscriber[b]&&!this.controlCenter.subscriber[h])return g&&X.warn(`${n} does not exist in ${Me.getMapping?"mapping file":"subscriber"} or you should use "simple" modifier.`),!1;u(this.publisher.notify,{target:e,daId:n.split(":")[0],parsed:d,sendType:r,extraData:s,bindData:o})}reportHandler({sa:e=null,sensors:t=null}={}){$e.report({sa:e,sensors:t})}bindEvent({event:e="",daId:t=""}={}){e&&t&&this.event.bindEventByDaId({event:e,daId:t})}getExposeInstance(e){return!e&&this.scrollInstance?this.scrollInstance:new We({publisher:this.publisher,...e,context:this})}}const Ve="undefined"==typeof window?{addSubscriber(){},triggerNotice(){},reportHandler(){},bindEvent(){},getExposeInstance(){},__instInfo:{}}:window.daEventCenterV2?window.daEventCenterV2:window.daEventCenterV2=new He("runtime");class Je{constructor(e){ne(this,E),ne(this,C),ne(this,S),ne(this,_),ne(this,P),ne(this,D),Y(this,"intersectionObserver",null),ne(this,g,new WeakSet),ne(this,m,new WeakSet),ne(this,y,{tap:ge(ye("__binding_tap")),expose:ge(ye("__binding_expose"))}),ne(this,w,null),ne(this,x,null),ne(this,I,new WeakMap);const t=e.daEventCenterInst||Ve;if("undefined"==typeof window)return!1;ie(this,w,{daEventCenterInst:e.daEventCenterInst||Ve,eId:e.eId||"",observerOptions:{root:null,rootMargin:"200px 200px 200px 200px",threshold:0,...e.observerOptions}}),ie(this,x,{immediate:t.getExposeInstance({delay:0}),delay:t.getExposeInstance()}),re(this,S,M).call(this)}tap(e,t){if(be(t))return!1;const n=fe();se.set(te(this,y).tap.set(e,n),t.value),te(this,g).has(e)||(this.intersectionObserver.observe(e),te(this,g).add(e))}expose(e,t){if(be(t))return!1;const n=fe();se.set(te(this,y).expose.set(e,n),t.value),te(this,g).has(e)||(this.intersectionObserver.observe(e),te(this,g).add(e))}get updated(){const{tap:e,expose:t}=te(this,y);return{tap:e.updateBindValue.bind(e),expose:e.updateBindValue.bind(t)}}get unmounted(){const{tap:e,expose:t}=te(this,y);return{tap:t=>{e.clear(t),re(this,D,j).call(this,t)},expose:e=>{t.clear(e),re(this,D,j).call(this,e)}}}}function Ge(e,t){const n="function"==typeof t?t():t||null,{vueVersion:i,eId:r,observerOptions:o,...s}={...n},a=new Je({daEventCenterInst:e,eId:r,observerOptions:o});if("undefined"!=typeof window){const t=e.__instInfo||{};X.info(`%c[sa-event-center] pkg version: ${t.version}, mode: ${t.mode}, vue-version: ${i}`,"color:green;font-size:14px;font-weight:bold;")}return{tap:ve({mounted:a.tap.bind(a),updated:a.updated.tap.bind(a),unmounted:a.unmounted.tap.bind(a)},i),expose:ve({mounted:a.expose.bind(a),updated:a.updated.expose.bind(a),unmounted:a.unmounted.expose.bind(a)},i)}}g=new WeakMap,m=new WeakMap,y=new WeakMap,w=new WeakMap,x=new WeakMap,I=new WeakMap,E=new WeakSet,k=async function(e){if(te(this,m).has(e))return!1;te(this,m).add(e),re(this,C,O).call(this,e),await re(this,_,A).call(this,e)},C=new WeakSet,O=function(e){if(!te(this,y).tap.getBindValue(e))return!1;const t=()=>{const{id:t,data:n}=te(this,y).tap.getBindValue(e),{daEventCenterInst:i,eId:r}=te(this,w);(de(t)?Me.legacyAbcd.triggerNotice:i.triggerNotice.bind(i))({daId:me(t,r),target:e,bindData:n})};re(this,P,T).call(this,e,"click",t),e.addEventListener("click",t)},S=new WeakSet,M=function(){const e=te(this,w).observerOptions,t=e=>{e.forEach((e=>{e.isIntersecting&&re(this,E,k).call(this,e.target)}))};"function"==typeof window.IntersectionObserver?this.intersectionObserver=new IntersectionObserver(t,e):this.intersectionObserver=new G(t,{scrollContainer:e.root,mask:e.rootMargin,threshold:e.threshold})},_=new WeakSet,A=async function(e){const{expose:t}=te(this,y),n=t.getBindValue(e);if(!n)return!1;const{id:i,container:r,code:o,once:s,prefix:a}=n,l=a||"def-prefix",{daEventCenterInst:c,eId:u}=te(this,w);let d=o||fe(),h=null==s||s;l&&(d=`${l}_${d||fe()}`),Re({code:d});const p="number"==typeof n.delay&&0==+n.delay?te(this,x).immediate:te(this,x).delay,f=()=>{p.directiveSubscribe(me(i,u),{elements:{code:d,container:r,target:e},once:h},{getBindInfo:t.getBindValue.bind(t),afterExpose:n.callback||null})};if(n.waitReady&&"true"!==e.dataset.ready){let t=null;const n=n=>{for(const i of n)"attributes"===i.type&&"data-ready"===i.attributeName&&"true"===e.dataset.ready&&(f(),t.disconnect(),t=null)};t=new MutationObserver(n),t.observe(e,{attributes:!0}),re(this,P,T).call(this,e,"observer",t)}else if(n.delayReady>0){const t=setTimeout(f,n.delayReady);re(this,P,T).call(this,e,"setTimeout",t)}else f()},P=new WeakSet,T=function(e,t,n){te(this,I).has(e)||te(this,I).set(e,[]),te(this,I).get(e).push({type:t,value:n})},D=new WeakSet,j=function(e){te(this,m).delete(e),te(this,g).delete(e);const t=te(this,I).get(e);if(!t||0===t.length)return!1;t.forEach((({type:e,value:t})=>{switch(e){case"setTimeout":window.clearTimeout(t);break;case"observer":t&&t.disconnect()}})),te(this,I).delete(e)};const{tap:qe,expose:ze}=Ge(Ve,(()=>{var e;let t="3";if("undefined"==typeof window)return{};const n=window.gbCommonInfo||{PLATFORM:""};return window.Vue?t=window.Vue.version:n&&n.PLATFORM&&(t="PWA"===n.PLATFORM?"2":"3"),t=+((null==(e=t.match(/\d+/))?void 0:e[0])||"3"),{vueVersion:+t,observerOptions:{}}}));function Ke(e){e.directive("tap",qe),e.directive("expose",ze)}}}]);
//# sourceMappingURL=32286-b4ca6d6b4f6c03c3.js.map