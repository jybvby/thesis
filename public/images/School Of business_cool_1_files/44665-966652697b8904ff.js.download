"use strict";(self.webpackChunkSHEIN_W=self.webpackChunkSHEIN_W||[]).push([[44665],{177279:(t,e,r)=>{r.d(e,{Vc:()=>h,JY:()=>d,Ay:()=>p,cA:()=>g});var s=r(97456),i=r(518295),a=r(433623);var n=r(665640);if("undefined"!=typeof window&&!(gbCommonInfo.ENABLE_MONITOR_UNION||""!==gbCommonInfo.ENABLE_MONITOR_UNION_PAGE&&gbCommonInfo.templateType===gbCommonInfo.ENABLE_MONITOR_UNION_PAGE)){const{PUBLIC_CDN:t,SERVER_TYPE:e,NODE_SERVER_ENV:s,IS_RW:o,SiteUID:c,appLanguage:l,currency:u}=gbCommonInfo;r.p=`${t}/she_dist/assets/`,i.h.init({server_type:"usa"===e?"us":e,brand:o?"romwe":"shein",device_type:"pc",language:l,currency:u,env:"production"===s?"production":"debug",site_uid:c}),i.h.registerField({member_id:function(){if("undefined"==typeof window)return"";let t=(0,a.R)("memberId");try{if(t)return t;const e=localStorage.getItem("auth_member")||"null";return(JSON.parse(e)||{value:{}}).value.member_id||""}catch(t){return""}},params(){var t;return{server_from:"aidc-web-pc",page_name:(null===(t=window.SaPageInfo)||void 0===t?void 0:t.page_name)||"other"}}});const h={cache:{loop_time:5e3},record_when_page_hidden:!0};if("localhost"===s){const t="1"==sessionStorage.getItem("skynet_fetch"),e="1"==sessionStorage.getItem("skynet_log");t||(h.http={generator:()=>t=>{var r;e&&n.log("@@@@@@@@@@@@@@@@@",t.url.replace(/.*\/app-track\//,""),null==t||null===(r=t.data)||void 0===r?void 0:r.data,"@@@@@@@@@@@@@@@@@")}})}i.h.config(h),(t=>{const{ERROR_JS_SWITCH_OLD_ON:e}=gbCommonInfo;if(!t||1==e)return;const r=function(e){const r=e.tag||e.errorMark||e.type||e.errorType;t.SILogger.logInfo({tag:r,message:r,params:e})},s=function(e){const{metricName:r,...s}=e;t.SIMetric.metricCount({metric_name:r,tags:s})};if(window.ErrorJs){var i,a,n,o,c,l;if(null!==(i=window.ErrorJs)&&void 0!==i&&null!==(a=i.log_proxy)&&void 0!==a&&null!==(n=a.queues)&&void 0!==n&&n.length)for(;window.ErrorJs.log_proxy.queues.length;){const t=window.ErrorJs.log_proxy.queues.shift();r(t)}if(null!==(o=window.ErrorJs)&&void 0!==o&&null!==(c=o.monitor_proxy)&&void 0!==c&&null!==(l=c.queues)&&void 0!==l&&l.length)for(;window.ErrorJs.monitor_proxy.queues.length;){const t=window.ErrorJs.monitor_proxy.queues.shift();s(t)}window.ErrorJs.log_proxy=r,window.ErrorJs.monitor_proxy=s}else window.ErrorJs={sendError:function(t,e,i){if(e.indexOf("/unusual")>-1)return i.reportList&&i.reportList.forEach((function(t){t.metricName&&s(t)})),void r(i);window.sa&&(window.sa(t,e,i),r(Object.assign(i,{tag:"error-js-report-other"})))}}})(i.h),r.e(151).then(r.bind(r,90786))}const o=i.h,c=i.h.SILogger,l=i.h.SIMetric,u=gbCommonInfo&&(gbCommonInfo.ENABLE_MONITOR_UNION||""!==gbCommonInfo.ENABLE_MONITOR_UNION_PAGE&&gbCommonInfo.templateType===gbCommonInfo.ENABLE_MONITOR_UNION_PAGE),h=u?s.Vc:c,d=u?s.JY:l,g=s.cA,p=u?s.h:o},236762:(t,e,r)=>{r.d(e,{AP:()=>i,CC:()=>s,Wb:()=>n,mz:()=>a});const s="disableAutoSelect",i=864e5,a="auth_member",n="ajhjkjalh778ah3kjnksSDHJsaAFkjr432jsa"},246752:(t,e,r)=>{r.d(e,{A:()=>p});const s={"/api/cart/add/create":{all:!0},"/api/cart/add_mall/create":{all:!0},"/api/cart/update":{all:!0},"/api/cart/update_attr_mall/update":{all:!0},"/api/cart/delete":{all:!0},"/api/cart/batchDelete/update":{all:!0},"/cart/saveforlater":{all:!0},"/api/user/wishlist/add":{all:!0},"/api/cart/batchWishGoods/update":{all:!0},"/api/checkout/paymentList/get":{all:!1,excludes:["card_no","card_pin"]},"/api/checkout/shippingList/get":{all:!1,excludes:["card_no","card_pin"]},"/checkout/cacu_total":{all:!0},"/api/checkout/mallCacuTotal/get":{all:!0},"/api/checkout/order/update":{all:!1,includes:["editType"]},"/checkout/switch_payment":{all:!0},"/ltspc/pay/unPay/unifiedPay":{all:!1,includes:["billno","paymentCode","routeId"]},"/ltspc/pay/binCheck":{all:!0},"/ltspc/pay/preRouting":{all:!0},"ltspc/pay/unPay/complete":{all:!0}},i=[{path:/^\/user\/orders\/detail\/\w+/,all:!0}];var a=r(665640);const n=[];let o="";const c=[],l=[/^\/(api\/)?(cart|user|checkout|getCouponListForOrderStore|getCouponListForOrder|pay|ltspc)/],u=["language","theme"],h=[0,1e3,-1],{NODE_SERVER_ENV:d,langPath:g}=gbCommonInfo;const p=new class{isFilterRoute(t){const e=t&&t.url&&t.url.split("?")[0];return c.includes(e)}isIncluseRoutes(t){const e=t;return l.some((t=>t.test(e)))}isReportCode(t={},e){const r=t&&Object.prototype.hasOwnProperty.call(t,"code")?t.code:"undefined";return"undefined"===r?e&&200!=e.status:!h.includes(parseInt(r,10))}isFilterEnvs(){return n.includes(d)}isFilterArea(t){return u.includes(t)}transformResponse(t){let e={};try{t.responseType&&"json"==t.responseType?e=t.response||t.responseJson:t.responseText&&(e=JSON.parse(t.responseText))}catch(e){a.log(t),a.log(e)}return e}parseString(t){try{return JSON.stringify(t)}catch(t){return""}}formatReportParams(t,e={},r,s={}){return"object"==typeof e&&Object.keys(e).forEach((r=>{this.isFilterArea(r)||("object"==typeof e[r]?t[r]=this.parseString(e[r]):t[r]=e[r])})),t=this.addRequstParams(t,r,s)}parseRequestParams(t,e=""){if("[object Object]"==Object.prototype.toString.call(t))return t;let r=Object.create(null);if("[object String]"==Object.prototype.toString.call(t)){if(e.includes("application/json")){try{r=JSON.parse(t)}catch(t){}return r}if(!(t=t.trim().replace(/^(\?|#|&)/,"")))return r;t.split("&").forEach((function(t){let e=t.replace(/\+/g," ").split("="),s=e.shift(),i=e.length>0?e.join("="):void 0;if(s=decodeURIComponent(s),s.endsWith("[]")&&(s=s.slice(0,-2)),void 0===i)i=null;else try{i=decodeURIComponent(i)}catch(t){}void 0===r[s]?r[s]=i:Array.isArray(r[s])?r[s].push(i):r[s]=[r[s],i]}))}return r}getRequestData(t,e){return"GET"==e.type?t.apiSearch||"":e.data||null}getNeedParsePath(t){const{apiPath:e}=t;let r={};if(s[e])return r=s[e],{isNeed:!0,pathConfig:r};const a=i.find((t=>{const{path:r}=t;return!!new RegExp(r).test(e)}));return a?{isNeed:!0,pathConfig:a}:{isNeed:!1,pathConfig:r}}addRequstParams(t,e,r={}){var s,i;const a=this.getRequestData(t,r);if(!a)return t;const{isNeed:n,pathConfig:o}=this.getNeedParsePath(t);if(!n)return t;const c=(null===(s=r.headers)||void 0===s?void 0:s["Content-Type"])||(null===(i=r.headers)||void 0===i?void 0:i["content-type"])||"",l=this.parseRequestParams(a,c),{includes:u=[],excludes:h=[],all:d}=o;let g={};return d?(g=l,t.requestParams=JSON.stringify(g),t):u.length>0?(u.forEach((t=>{void 0!==l[t]&&(g[t]=l[t])})),t.requestParams=JSON.stringify(g),t):h.length>0?(Object.keys(l).forEach((t=>{h.includes(t)||(g[t]=l[t])})),t.requestParams=JSON.stringify(g),t):(t.requestParams=JSON.stringify(g),t)}formatApiPath(t){const e=t.indexOf("/ltspc");return e>=0?t.slice(e):t.replace(g,"")}getPublicParams(t,e){const r={};let[s="",i=""]=e.url&&e.url.split("?")||[];const a=document.createElement("a");return a.href=s,s=a.pathname,r.apiPath=this.formatApiPath(s),this.customParam({obj:r,xhr:t,opts:e}),r.apiSearch=i,r.userAgent=navigator&&navigator.userAgent||"",r.page_name=window.getSaPageInfo&&window.getSaPageInfo.page_name||window.SaPageInfo&&window.SaPageInfo.page_name||"",r.status_code=t.status,r.cookieSize=document&&document.cookie&&document.cookie.length,r.hrefSize=location&&location.href&&location.href.length,r}customParam({obj:t,opts:e}){if(t.apiPath.indexOf("/unifiedPay")>-1){let r=e.data.split("&");r=r.filter((t=>t.indexOf("paymentCode")>-1)),r=r[0]&&r[0].split("=")||[];const s=r[1]||"";t.payment_code=s}}sendReport(t,e={},r={}){try{if(this.isFilterEnvs())return;const t=this.transformResponse(e);if(!this.isReportCode(t,e))return;const s=this.getPublicParams(e,r);if(this.isFilterRoute(r))return;if(!this.isIncluseRoutes(s.apiPath))return;if("undefined"==typeof sa)return;this.formatReportParams(s,t,e,r),this.report(s)}catch(t){a.log(t)}}sendReportForScHttp(t){this.sendReport(null,null==t?void 0:t.request,null==t?void 0:t.config)}report(t){try{if("undefined"==typeof sa)return;if(!o){const{SA_REPORT_URL:t}=gbCommonInfo.REPORT_URL;o=`${t}/orgSsaUnusual`}window.sa("error",o,t)}catch(t){a.log(t)}}}},348668:(t,e,r)=>{r.d(e,{iy:()=>a});var s=r(433623);const i=[["s","search"],["r","recommend"],["u","userGrowth"]],a=t=>{const e={},r=(()=>{const t=(0,s.R)("uswitch");let e;if(t){const r=decodeURIComponent(t).split(".").map((t=>t.split("-")));e=i.reduce(((t,e)=>{const s=r.find((([t,r])=>t===e[0]&&0==r));return t[e[1]]=s?0:1,t}),{})}return e})();return r&&Object.keys(r).length&&(e["uberctx-personal-switch"]=encodeURIComponent(JSON.stringify(r))),t.headers=Object.assign(e,t.headers),t}},404266:(t,e,r)=>{r.d(e,{lt:()=>f});var s=r(846825),i=r(794103),a=r(383112),n=r(976369),o=r(665640);const c=class{constructor(){(0,i.A)(this,"isSupportGeetest",!0),(0,i.A)(this,"isShouldInit",!1),(0,i.A)(this,"info",{}),(0,i.A)(this,"challange",""),(0,i.A)(this,"verifyCb",[]),(0,i.A)(this,"gtInstance",null),(0,i.A)(this,"from",""),(0,i.A)(this,"isReInitStatus",!1),(0,i.A)(this,"isGtInstanceReady",!1),(0,i.A)(this,"errorTriggerTimes",0),(0,i.A)(this,"reInitTimes",0),(0,i.A)(this,"riskMaskValue",""),(0,i.A)(this,"isResetting",!1),(0,i.A)(this,"chanllangeTimestap",0),(0,i.A)(this,"ajaxParams",""),(0,i.A)(this,"staticUrl",""),(0,i.A)(this,"fullpageJs","")}register(t,e=""){(0,a.A)({url:"/risk/verify/identity/geetest/register",timeout:2e4,method:"POST",data:{validate_type:e}}).then((r=>{var s;const{code:i,info:a}=r;if(this.fullpageJs=(null==a?void 0:a.fullpage)||"",this.staticUrl=(null==a||null===(s=a.static_servers)||void 0===s?void 0:s[0])||"",this.info=a,this.isShouldInit=0==i,this.isShouldInit)return this.chanllangeTimestap=Date.now(),void this.fetchFullPageResource(t,!!e);this.isReInitStatus&&(this.isReInitStatus=!1),"function"==typeof t&&t({status:"pass"})})).catch((e=>{this.errorReport(e,e.statusText,"/geetest/register"),this.isReInitStatus||"function"==typeof t&&t({status:"error"})}))}showInitGTinstance(){return!0}urlConversion(t){return t=t.replace(/^(https?:\/\/)([0-9a-z.]+)(:[0-9]+)?([/0-9a-z.]+)?(\?[0-9a-z&=]+)?(#[0-9-a-z]+)?/i,"https://$2$3$4$5$6")}fetchFullPageResource(t){if(!this.isShouldInit||!this.isSupportGeetest)return;if(1==this.isGtInstanceReady)return void this.initGeetestInstance(t);this.staticUrl=this.urlConversion(this.staticUrl);const e=`${this.staticUrl}/${this.fullpageJs}`;(0,n.t)({label:"script",attrs:{async:!0,src:e}}).then((()=>{this.initGeetestInstance(t)})).catch((e=>{o.log("fullpage.js error ......"),o.log(e),this.errorReport(e,"fullpage.js load error",""),"function"==typeof t&&t({status:"error"})}))}initGeetestInstance(t){const e={...this.info,product:"bind",lang:(r=gbCommonInfo.appLanguage,"pt-br"===r?"pt":"he"===r?"iw":r),next_width:"300px",timeout:2e4,pure:!0};var r;try{const r=new window.Geetest(e);r.onReady((()=>{this.isGtInstanceReady=!0,this.gtInstance=r,"function"==typeof t&&t({status:"complete"}),this.verifyCb.length>0&&this.gtInstance.verify()})),r.onSuccess((()=>{const{geetest_challenge:t}=r.getValidate();setTimeout((()=>{this.verifyCb.forEach((e=>{e({status:"success",challenge:t,risk:this.riskMaskValue}),this.verifyCb.shift()}))}),0)})),r.onClose((()=>{this.verifyCb.forEach((t=>{t({status:"close"}),this.verifyCb.shift()}))})),r.onError((e=>{o.log("error sdk ....",e),this.errorReport(e,"sdk error",""),"function"==typeof t&&t({status:"error"}),this.verifyCb.forEach((t=>{t({status:"error"}),this.verifyCb.shift()}))}))}catch(e){this.errorReport(e.stack,"sdk init error",""),"function"==typeof t&&t({status:"error"})}}verify(t,e=""){var r;o.log("reInitTimes",this.reInitTimes),!this.isGtInstanceReady||this.reInitTimes>=4?t({status:"error"}):(this.from=e,"function"==typeof t&&this.verifyCb.push(t),null===(r=this.gtInstance)||void 0===r||r.verify())}verifyPromise(t,e=""){return new Promise((t=>{this.verify((e=>{t(e)}),e)}))}recallVerfy(){this.isResetting&&this.verifyCb.length>0&&this.gtInstance.verify()}reset(){this.isResetting=!0,this.gtInstance.reset()}reInitGt(){this.reInitTimes>5||(this.reInitTimes++,this.isReInitStatus=!0)}errorReport(t,e,r){const s=t&&t.target?t.target:t;if("object"==typeof s&&("1021"==s.error_code||"1012"==s.error_code))return;this.errorTriggerTimes++;const{SA_REPORT_URL:i}="undefined"!=typeof gbCommonInfo&&gbCommonInfo.REPORT_URL||{};"undefined"!=typeof ErrorJs&&ErrorJs.sendError("error",i+"/unusual",{errorMark:"GeeTestBrowserError",errorType:e,errorInfo:JSON.stringify(s),errorPath:r,errrorTimes:this.errorTriggerTimes})}};var l=r(113131),u=r(25165),h=r(28366),d=r(665640);const g="_f_c_llbs_";async function p(t){const e=1==window.GB_RISK_CHALLEGE_LIMIT?new c:new s.A,r=(1==window.GB_RISK_CHALLEGE_LIMIT?{901:"gee_slide",902:"gee_click"}:{901:"slide",902:"icon"})[t]||"";if(!r){return{status:"geetest_error",msg:"captcha_type not support"}}const i=await function(t,e){return new Promise((r=>{e.register(r,t)}))}(r,e),{status:a}=i;if("error"==a){return{status:"geetest_error",msg:"geetest init error"}}const{status:n,challenge:o,risk:l}=await e.verifyPromise("","flow_challenge");if("close"==n){return{status:"geetest_close",msg:""}}if("error"==n){return{status:"geetest_error",msg:"geetest request error"}}return{status:"success",challenge:o,risk:l}}async function f(t,e,r){let s={},i="";if(![901,902,903,904,905].includes(Number(t)))return{status:"error",challenge:"",risk:""};try{const{"risk-id":t}=(0,h.J)(location.search);if(t){var n,o,c,f,m,y,v,_,w;null===(n=window)||void 0===n||n.sa("set","setPageData",window.SaPageInfo),null===(o=window)||void 0===o||o.sa("send","pageEnter",{start_time:(new Date).getTime()}),window.onbeforeunload=function(){var t;null===(t=window)||void 0===t||t.sa("send","pageLeave",{end_time:(new Date).getTime()})};const e=(null===(c=window)||void 0===c||null===(f=c.AntiIn)||void 0===f?void 0:f.syncGetAllEncrypted(null===(m=window)||void 0===m?void 0:m.AntiIn.Channel.PC))||null,r=encodeURIComponent(location.href),s=(null===(y=window)||void 0===y?void 0:y.__ArmorToken)||(null===(v=window)||void 0===v?void 0:v.sessionStorage.getItem("armorToken"))||(null===(_=window)||void 0===_?void 0:_.localStorage.getItem("armorToken"))||null;null===(w=window)||void 0===w||w.sa("send",{activity_name:"expose_risk_envinfo",activity_param:{origin_risk_id:t,anti_in:e,armortoken:s,risk_url:r}})}}catch(t){d.log("error",t)}switch(Number(t)){case 901:case 902:i="anti_crawler_gee",s=await p(t);break;default:i="anti_crawler_RT",s=await async function(t,e){const{"risk-id":r}=(0,h.J)(location.search);u.default.init({axiosInstance:a.A,rate:5e3});const s={validate_type:{903:"js_challenge",904:"gee_slide",905:"gee_click"}[t],validate_scene:"anti_crawler_RT",validate_channel:0,validate_param:{decision_id:e||r||""}};return new Promise((t=>{u.default.doVerify(s,(e=>{var r;const{isSuccess:s}=e;t({status:s?"success":"error",challenge:"",risk:"",validate_token:(null==e||null===(r=e.info)||void 0===r?void 0:r.validate_token)||""})})).catch((e=>{t({status:"error",challenge:"",risk:""})}))}))}(t,r)}const{status:I,challenge:b,risk:S,validate_token:k}=s;if("success"!=I)return s;const R={challenge:b,captcha_type:t,gRisk:S,validate_scene:i,validate_token:k||""},A=await(0,a.A)({url:"/api/risk/flow_check",method:"POST",data:R}).catch((t=>t)),C={status:0==A.status?"success":"risk_error",code:A.status,llbs:A.llbs||""};if(0==A.status){const t=parseInt(e)||0;(0,l.T)({key:g,value:A.llbs,end:2*t})}return C}},476934:(t,e,r)=>{r.d(e,{F:()=>a});var s=r(177279);const i=["/api/abt/userinfo/query","/api/common/language/get","/api/robot/match/query","/api/robot/dialog/get","/api/robot/match/multi/query","/api/robot/channel/check/query","/api/robot/chat/template/query","/api/robot/zdtk/template/query","/api/robot/theme/get","/api/robot/chat/check/query","/api/robot/gwotk/tax/create","/api/robot/gwotk/dulyDeliver/create","/api/robot/cstk/create","/api/robot/gwotk/create","/api/robot/gwotk/quality/create","/api/robot/cschat/token/get","/api/robot/cschat/end/delete","/api/robot/cschat/conversation/create","/api/robot/cschat/message/create","/api/robot/cschat/evaluation/create","/api/robot/cschat/messageReport/create","/api/productList/info/get","/api/cart/update","/api/cart/delete","/api/cart/getIntegrityPromotionInfo/get","/api/cart/batchDelete/update","/api/cart/batchWishGoods/update","/api/cart/modifyCartCheckStatus/update","/api/cart/add_mall/create","/api/cart/batch_add_mall/create","/api/cart/update_attr_mall/update","/api/cart/getPromotionById/get","/api/cart/postFreeMall/get","/api/cart/getCartAllInfo/get","/api/checkout/get","/api/checkout/mallOrder/create","/api/pay/unifiedPay/create","/result/unifiedCb","/pay/result/success","/pay/result/fail","/api/giftcard/checkout/order/create","/api/user/dashboard/base/get","/api/user/addressbook/addressCheckRule/get","/api/user/addressbook/countrySensitiveList/query","/api/user/addressbook/storeConfigInfo/get","/api/user/addressbook/accountAndOrderEmail/get","/api/orders/base/queryAddressInfo/query","/api/user/addressbook/universalCountryList/get","/api/user/addressbook/addressFormConfigByInfo/get","/api/user/addressbook/limitAddr/query","/api/coupon/getCouponPackage/init","/api/coupon/bindCouponPackage/update","/api/coupon/getCouponRemind/init"];function a(t,{responseTime:e}){i.some((e=>e===t))&&s.JY.metricTime({metric_name:"web_request_duration",tags:{path:t},value:e},{random:.05})}},846825:(t,e,r)=>{r.d(e,{A:()=>l});var s=r(794103),i=r(383112),a=r(976369),n=r(665640);const o={forgetPassword:"click_fpwordriskverify",forgetPhone:"click_fpwordriskverify",resetPhone:"click_fpwordriskverify",loginEmail:"click_loginriskverify",loginPhone:"click_loginriskverify",phoneCodeSend:"click_loginriskverify",signupEmail:"click_registerriskverify",signupPhone:"click_registerriskverify",quickRegister:"click_registerriskverify"},c=["JyRisk","JyRiskReg","JyRiskZTReg"];const l=class{constructor(){(0,s.A)(this,"abtResult",{}),(0,s.A)(this,"isSupportGeetest",!0),(0,s.A)(this,"isShouldInit",!1),(0,s.A)(this,"info",{}),(0,s.A)(this,"challange",""),(0,s.A)(this,"verifyCb",[]),(0,s.A)(this,"gtInstance",null),(0,s.A)(this,"from",""),(0,s.A)(this,"isReInitStatus",!1),(0,s.A)(this,"isGtInstanceReady",!1),(0,s.A)(this,"errorTriggerTimes",0),(0,s.A)(this,"reInitTimes",0),(0,s.A)(this,"riskMaskValue",""),(0,s.A)(this,"isResetting",!1),(0,s.A)(this,"isSetXhrListen",!1),(0,s.A)(this,"chanllangeTimestap",0),(0,s.A)(this,"ajaxParams",""),(0,s.A)(this,"staticUrl",""),(0,s.A)(this,"fullpageJs","")}register(t,e=""){(0,i.A)({url:`/geetest/register?riskType=${e}`,timeout:2e4}).then((r=>{var s;const{status:i,data:a}=r;if(this.fullpageJs=(null==a?void 0:a.fullpage)||"",this.staticUrl=(null==a||null===(s=a.static_servers)||void 0===s?void 0:s[0])||"",this.info=a,this.isShouldInit=0==i,this.isShouldInit)return this.chanllangeTimestap=Date.now(),this.listenXhrComplete(),void this.fetchFullPageResource(t,!!e);this.isReInitStatus&&(this.isReInitStatus=!1),"function"==typeof t&&t({status:"pass"})})).catch((e=>{this.errorReport(e,e.statusText,"/geetest/register"),this.isReInitStatus||"function"==typeof t&&t({status:"error"})}))}listenXhrComplete(){if(this.isSetXhrListen)return;this.isSetXhrListen=!0;const t=XMLHttpRequest.prototype.open,e=this;XMLHttpRequest.prototype.open=function(){let r=arguments;this.addEventListener("load",(function(){/geetest\/ajax\.php$/.test(this.responseURL)&&e.sendGtVerifyResult(this.responseText),/geetest\/reset\.php$/.test(this.responseURL)&&(e.chanllangeTimestap=Date.now(),e.recallVerfy(),e.isResetting=!1)})),this.addEventListener("error",(function(t){const s=r&&r[1];s&&/geetest\/(ajax|get|refresh|reset)\.php$/.test(s)&&(e.errorReport(t,"network error",s),e.isGtInstanceReady||"function"==typeof e.initCb&&e.initCb())})),this.addEventListener("timeout",(function(t){const s=r&&r[1];s&&/geetest\/(ajax|get|refresh|reset)\.php$/.test(s)&&(e.errorReport(t,"timeout",s),e.isGtInstanceReady||"function"==typeof e.initCb&&e.initCb())})),/geetest\/ajax\.php$/.test(r[1])&&(e.isSendingAjaxPhP=!0),t.apply(this,r)};const r=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){!0===e.isSendingAjaxPhP&&(e.ajaxParams=arguments[0],e.isSendingAjaxPhP=!1),r.apply(this,arguments)}}sendGtVerifyResult(t){let e={};try{e=JSON.parse(t)}catch(t){}const r=e.data||{};this.riskMaskValue=r&&r.risk;let s=1;0===e.status&&"success"===r.result&&"fullpage"===r.sub_type&&(s=0);const i=o[this.from];if(!this.from)return;const a="undefined"!=typeof SaPageInfo?SaPageInfo:{start_time:Date.now()},n={verification_result:s,sessionid_shein:e.token||""};r.sub_type&&(n.sub_type=r.sub_type),r.score&&(n.score=r.score),r.result&&(n.success="success"===r.result?0:1);const c=Object.assign({},a,{activity_name:i,activity_param:n});sa("send",c)}async getGtAbtResult(t){if(!this.isSupportGeetest)return"function"==typeof t&&t({status:"not_support"});this.initCb=t;try{let e={JyRisk:{param:"on",poskeys:"JyRisk"},JyRiskReg:{param:"on",poskeys:"JyRiskReg"},JyRiskZTReg:{param:"on",poskeys:"JyRiskZTReg"}};if(this.setAbtResult(e),this.showInitGTinstance())return void this.register(t)}catch(t){this.abtResult={}}this.isShoudInitGt=!1,"function"==typeof t&&t({status:"error"})}setAbtResult(t){c.forEach((e=>{this.abtResult[e]=t[e]||{}}))}getItemResult(t){return!(this.abtResult[t]&&"off"===this.abtResult[t].param)&&this.isShouldInit}showInitGTinstance(){return!0}urlConversion(t){return t=t.replace(/^(https?:\/\/)([0-9a-z.]+)(:[0-9]+)?([/0-9a-z.]+)?(\?[0-9a-z&=]+)?(#[0-9-a-z]+)?/i,"https://$2$3$4$5$6")}fetchFullPageResource(t){if(!this.isShouldInit||!this.isSupportGeetest)return;if(1==this.isGtInstanceReady)return void this.initGeetestInstance(t);this.staticUrl=this.urlConversion(this.staticUrl);const e=`${this.staticUrl}/${this.fullpageJs}`;(0,a.t)({label:"script",attrs:{async:!0,src:e}}).then((()=>{this.initGeetestInstance(t)})).catch((e=>{n.log("fullpage.js error ......"),n.log(e),this.errorReport(e,"fullpage.js load error",""),"function"==typeof t&&t({status:"error"})}))}initGeetestInstance(t){const e={...this.info,product:"bind",lang:(r=gbCommonInfo.appLanguage,"pt-br"===r?"pt":"he"===r?"iw":r),next_width:"300px",timeout:2e4,pure:!0};var r;try{const r=new window.Geetest(e);r.onReady((()=>{this.isGtInstanceReady=!0,this.gtInstance=r,"function"==typeof t&&t({status:"complete"}),this.verifyCb.length>0&&this.gtInstance.verify()})),r.onSuccess((()=>{const{geetest_challenge:t}=r.getValidate();setTimeout((()=>{this.verifyCb.forEach((e=>{e({status:"success",challenge:t,risk:this.riskMaskValue}),this.verifyCb.shift()}))}),0)})),r.onClose((()=>{this.verifyCb.forEach((t=>{t({status:"close"}),this.verifyCb.shift()}))})),r.onError((e=>{n.log("error sdk ....",e),this.errorReport(e,"sdk error",""),"function"==typeof t&&t({status:"error"}),this.verifyCb.forEach((t=>{t({status:"error"}),this.verifyCb.shift()}))}))}catch(e){this.errorReport(e.stack,"sdk init error",""),"function"==typeof t&&t({status:"error"})}}verify(t,e=""){var r;n.log("reInitTimes",this.reInitTimes),!this.isGtInstanceReady||this.reInitTimes>=4?t({status:"error"}):(this.from=e,"function"==typeof t&&this.verifyCb.push(t),null===(r=this.gtInstance)||void 0===r||r.verify())}verifyPromise(t,e=""){return new Promise((r=>{if(!this.getItemResult(t))return r({status:"abt-off"});this.verify((t=>{r(t)}),e)}))}recallVerfy(){this.isResetting&&this.verifyCb.length>0&&this.gtInstance.verify()}reset(){this.isResetting=!0,this.gtInstance.reset()}reInitGt(t){this.reInitTimes>5||(this.reInitTimes++,this.isReInitStatus=!0,this.getGtAbtResult(t))}errorReport(t,e,r){const s=t&&t.target?t.target:t;if("object"==typeof s&&("1021"==s.error_code||"1012"==s.error_code))return;this.errorTriggerTimes++;const{SA_REPORT_URL:i}="undefined"!=typeof gbCommonInfo&&gbCommonInfo.REPORT_URL||{};"undefined"!=typeof ErrorJs&&ErrorJs.sendError("error",i+"/unusual",{errorMark:"GeeTestBrowserError",errorType:e,errorInfo:JSON.stringify(s),errorPath:r,errrorTimes:this.errorTriggerTimes})}}},853447:(t,e,r)=>{r.d(e,{rC:()=>b,Uo:()=>S});var s=r(360442),i=r(665640);function a(t,e=null){i.log(`%c [userActionTracker] %c ${t}`,"color: #fff; background: #6dc260;font-size: 10px; padding: 2px;","color: #333; background: #fff; font-size: 10px;padding: 2px;",e)}class n{constructor({saNames:t,singleKey:e,saNameDefaultLimit:r,handleAction:s}){this.saNameMap=this.initSaNameMap(t),this.saNameDefaultLimit=r||30,this.isStart=!1,this.sessionId=null,this.singleKey=e||!1,this.onWatch=()=>{},this.data={},this.onceData={},this.handleAction=s||(t=>t)}initSaNameMap(t=[]){if(!Array.isArray(t))return{list:[],moreNames:[]};const e=[],r=[];return t.forEach((t=>{"string"==typeof t&&(t={saName:t,limit:this.saNameDefaultLimit}),t.saName.includes(",")?e.push(t):r.push(t)})),{list:r,moreNames:e}}getData(){const t=this.onceData||{};if(Object.keys(t).length>0){const e=function(t,e){return Object.keys(t).reduce(((r,s)=>{r[s]=t[s];const i=e[s];if(!i)return r;const a=t[s]||{},n=Object.keys(i).reduce(((t,e)=>{const r=a[e]||[],s=i[e]||[],n=r.map((t=>{var e;return null==t||null===(e=t.activity_param)||void 0===e?void 0:e._actionId})).filter(Boolean);return t[e]=[...r,...s.filter((t=>!n.includes(t.id)))],t}),{});return r[s]={...a,...n},r}),{})}(this.data,t);return this.onceData={},e}return this.data}setInitData(t={}){this.data=Object.assign({},t);let e=Object.keys(this.data);0!==e.length&&(this.singleKey||(e=e.sort(((t,e)=>e-t))),this.sessionId=e[0],this.isStart=!0)}registerHandler({watch:t}){this.onWatch=t}startCollect({to:t,from:e}){this.isStart=!0,this.sessionId?this.singleKey||this.handleMoreSessionIdData({to:t,from:e}):this.sessionId=Date.now(),this.data[this.sessionId]||(this.data[this.sessionId]={_routeData:{to:{query:t.query,params:t.params,path:t.path},from:{query:e.query,params:e.params,path:t.path}}})}handleMoreSessionIdData({to:t,from:e}){var r,s,i;const a=Object.keys(this.data);if(!a.some((e=>{var r,s,i;return(null===(r=this.data[e])||void 0===r||null===(s=r._routeData)||void 0===s||null===(i=s.to)||void 0===i?void 0:i.path)===t.path})))return void(this.sessionId=Date.now());const n=a.sort(((t,e)=>e-t)),o=n[0];if((null===(r=this.data[o])||void 0===r||null===(s=r._routeData)||void 0===s||null===(i=s.to)||void 0===i?void 0:i.path)===t.path)return void(this.sessionId=o);const c=n.findIndex((e=>{var r,s,i;return(null===(r=this.data[e])||void 0===r||null===(s=r._routeData)||void 0===s||null===(i=s.to)||void 0===i?void 0:i.path)===t.path})),l=n[c],u=this.data[l];if(u._routeData.to.path===t.path&&u._routeData.from.path===e.path)this.sessionId=Date.now();else{this.sessionId=l;const t=n.slice(0,c+1).reduce(((t,e)=>(t[e]=this.data[e],t)),{});this.data=t}}endCollect(){this.isStart=!1,this.data={},this.onWatch(this.data)}getSaName(t){var e,r,s,i;if(!this.isStart||!(null!==(e=this.saNameMap)&&void 0!==e&&null!==(r=e.list)&&void 0!==r&&r.length||null!==(s=this.saNameMap)&&void 0!==s&&null!==(i=s.moreNames)&&void 0!==i&&i.length||null==t)&&t.activity_name)return{};return{saName:this.saNameMap.list.find((e=>e.saName===t.activity_name)),moreSaName:this.saNameMap.moreNames.find((e=>{var r,s;return null==e||null===(r=e.saName)||void 0===r||null===(s=r.split(","))||void 0===s?void 0:s.includes(t.activity_name)}))}}handleSaNameLimitData({saName:t,moreSaName:e}){const r=this.data[this.sessionId],s=({item:t})=>{if(!t)return;const e=t.limit||this.saNameDefaultLimit,s=r[t.saName]||[];s.length>=e&&s.shift()};[e,t].forEach((t=>s({item:t})))}trigger(t){this.handleSetData(t,this.data)}onceSet(t={},{to:e,from:r}){!Object.keys(this.data||{}).length&&e&&r&&this.startCollect({to:e,from:r}),this.onceData[this.sessionId]||(this.onceData[this.sessionId]={});const s=Math.random().toString(36).slice(6);return t.id=s,this.handleSetData(t,this.onceData),s}handleSetData(t,e){const r=e[this.sessionId];if(!r)return;const{saName:s,moreSaName:i}=this.getSaName(t);if(!s&&!i)return!1;this.handleSaNameLimitData({saName:s,moreSaName:i});const{activity_name:a,activity_param:n,page_name:o,page_param:c,timestamp:l,end_time:u}=t,h=({saName:s}={})=>{if(!s)return;r[s]||(r[s]=[]);const i={activity_name:a,activity_param:{...n||{},_actionId:null==n?void 0:n._actionId},page_param:Object.assign({},c),page_name:o,timestamp:l,end_time:u};t.id&&(i.id=t.id);const h=this.handleAction?this.handleAction(i,this.data,{result:e}):i;h&&r[s].push(h)};[i,s].forEach((t=>h(t))),this.onWatch(e,t)}}class o{constructor({targetPaths:t,clearDataPaths:e,singleKey:r}){this.startState=!1,this.userRouterActions=[],this.targetPaths=t||[],this.clearDataPaths=e||[],this.singleKey=r||!1}getData(){return this.userRouterActions}setInitData(t){this.userRouterActions=Array.isArray(t)?t:[],this.startState=this.userRouterActions.length>0}trigger(t={},e={}){if(t.path===e.path)return;if(!this.onStartCallback)throw new Error("请注册开始回调");if(0===this.targetPaths.length)return;let r=this.userRouterActions;if(!this.singleKey){const t=Object.keys(this.userRouterActions).sort(((t,e)=>e-t));r=[this.userRouterActions[t[0]]]}r.some((r=>{var s,i;return(null==r||null===(s=r.to)||void 0===s?void 0:s.path)===(null==t?void 0:t.path)&&(null===(i=r.from)||void 0===i?void 0:i.path)===e.path}))||(this.onStart(t,e),this.recordRouterAction(t,e))}registerHandler({onStartCallback:t,onEndCallback:e,targetTriggerCallback:r,watch:s}){this.onStartCallback=t||(()=>{}),this.onEndCallback=e||(()=>{}),this.targetTriggerCallback=r||(()=>{}),this.onWatch=s||(()=>{})}onStart(t,e){if(this.startState)return;(this.isHitTargetRouter({to:t})||this.userRouterActions.length>0)&&(this.startState=!0,this.onStartCallback({to:t,from:e}))}isHitTargetRouter({to:t}){return this.targetPaths.some((e=>{if(e){return new RegExp(e).test(t.path)}return!1}))}onEnd(){this.startState=!1,this.onEndCallback(),this.userRouterActions=[],this.onWatch(this.userRouterActions)}recordRouterAction(t,e){if(!this.startState)return;const r={to:{path:t.path},from:{path:e.path}};this.userRouterActions.push(r),this.isEnd({to:t,from:e})?this.onEnd():(this.isHitTargetRouter({to:t})&&this.targetTriggerCallback({to:t,from:e}),this.onWatch(this.userRouterActions))}isEnd({to:t}){if(this.clearDataPaths.some((e=>{if(e){return new RegExp(e).test(t.path)}return!1})))return!0;if(0===this.userRouterActions.length)return!1;const{to:{path:e},from:{path:r}}=this.userRouterActions[0],s=`${e}_${r}`,i=`${r}_${e}`,a=this.userRouterActions.filter((t=>{const{to:{path:e},from:{path:r}}=t;return`${e}_${r}`===s})),n=this.userRouterActions.filter((t=>{const{to:{path:e},from:{path:r}}=t;return`${e}_${r}`===i}));return a.length===n.length}}class c{constructor({debug:t}){this.debug=t||!1,this.collectDataInstanceHandlers=[],this.routerActionInstanceHandlers=[]}registerHandler({key:t,collectDataInstance:e,routerActionInstance:r}){const i=`action_track_${t}_collect`,n=`action_track_${t}_router`,o=(0,s.getSessionStorage)(n),c=(0,s.getSessionStorage)(i);c&&e.setInitData(c),o&&r.setInitData(o),e.registerHandler({watch:(e,r)=>{(0,s.setSessionStorage)({key:i,value:e}),this.debug&&a(`[${t}]收集数据发生变化`,e)}}),this.collectDataInstanceHandlers.push(e),r.registerHandler({onStartCallback:r=>{this.debug&&a(`[${t}]收集start`),e.startCollect(r)},onEndCallback:()=>{this.debug&&a(`[${t}]收集数据end，清空数据`),e.endCollect()},targetTriggerCallback:t=>{e.startCollect(t)},watch:e=>{(0,s.setSessionStorage)({key:n,value:e}),this.debug&&a(`[${t}]路由行为发生变化`,e)}}),this.routerActionInstanceHandlers.push(r),this.debug&&a(`[${t}]注册成功,初始化数据`,{collectData:e.getData(),routerAction:r.getData()})}triggerCollectDataHandlers(t){this.collectDataInstanceHandlers.forEach((e=>{e.trigger(t)}))}triggerRouterActionHandlers(t,e){this.routerActionInstanceHandlers.forEach((r=>{r.trigger(t,e)}))}}var l=r(665640);const u=(t=[])=>null!=t&&t.length?t[t.length-1]:void 0,h=(t=[],e=",")=>null!=t&&t.length?t.join(e):void 0,d=[{featureKey:"detailsRecommend",saNames:["click_attribute","click_sort","expose_goods_list","click_category","click_goods_list_label","page_view"],targetPaths:[[/^\/daily-new\.html$/,/^\/coupon-product\.html$/,/^\/sellingpoint-(\d+)-(\d+)-.+\.html$/,/^\/.+-c-(\d+)\.html$/,/^\/((\w+)\/)?.+-sc-([A-Za-z0-9]+)\.html$/,/^\/pdsearch\/([^\/]+)\/?$/,/^\/([a-z]+-picks|romwe-[a-z]+|promo-discount)(-list-([a-zA-Z0-9]+))?\.html$/].map((t=>t.source)).join("|")],clearDataPaths:[],handleAction(t){var e,r;return"page_view"===t.activity_name?"page_search"===t.page_name&&null!==(e=t.page_param)&&void 0!==e&&e.result_content?{result_content:null===(r=t.page_param)||void 0===r?void 0:r.result_content}:null:t},onTrigger({collectData:t,routerAction:e}){l.warn("detailsRecommend before",t,e);const r=[],s=[],i=[],a=[],n=[],o=[],c=[],d=[];Object.keys(t).forEach((e=>{var l,g,p,f,m,y,v,_;const{click_attribute:w=[],click_sort:I=[],expose_goods_list:b=[],click_category:S=[],click_goods_list_label:k=[],page_view:R=[],_routeData:A={}}=t[e]||{},C=(null==A?void 0:A.to)||{},E=null==w?void 0:w.filter((t=>{var e;return null==t||null===(e=t.activity_param)||void 0===e?void 0:e.attribute_list})),T=null==w?void 0:w.filter((t=>{var e;return null==t||null===(e=t.activity_param)||void 0===e?void 0:e.price_range})),P=null===(l=u(E))||void 0===l||null===(g=l.activity_param)||void 0===g?void 0:g.attribute_list,L=null===(p=u(T))||void 0===p||null===(f=p.activity_param)||void 0===f?void 0:f.price_range;var N,O;(P&&r.push(h([e,P])),L&&s.push(h([e,L])),null!=I&&I.length)&&i.push(h([e,(null===(N=u(I))||void 0===N||null===(O=N.activity_param)||void 0===O?void 0:O.sort)||"0"]));const D=null===(m=C.path)||void 0===m?void 0:m.match(new RegExp("pdsearch/.+")),x=R.filter((t=>null==t?void 0:t.result_content));if(D){var j,U,J,G;const t=null==b||null===(j=b[0])||void 0===j||null===(U=j.activity_param)||void 0===U||null===(J=U.goods_list)||void 0===J||null===(G=J.split("`"))||void 0===G?void 0:G[0];t&&d.push(h([e,t]))}D&&null!==(y=u(x))&&void 0!==y&&y.result_content&&a.push(h([e,u(x).result_content],"`"));if((null===(v=C.query)||void 0===v?void 0:v.categoryJump)||"sbc"===(null===(_=C.query)||void 0===_?void 0:_.entranceType)){var q,$,H,M;const t=null==b||null===(q=b[0])||void 0===q||null===($=q.activity_param)||void 0===$||null===(H=$.goods_list)||void 0===H||null===(M=H.split("`"))||void 0===M?void 0:M[0];t&&n.push(h([e,t]))}var V,B,F,W;null!=S&&S.length&&o.push(h([e,null===(V=u(S))||void 0===V||null===(B=V.activity_param)||void 0===B?void 0:B.category_id]));null!=k&&k.length&&c.push(h([e,null===(F=u(k))||void 0===F||null===(W=F.activity_param)||void 0===W?void 0:W.label_id]))}));const g={rec_ctx:{rt_ft_list_filter:h(r),rt_ft_list_price:h(s),rt_f_list_sort:h(i),rt_f_search_identifier:h(a,"`"),rt_f_list_top_goods:h(n),rt_f_list_category_id:h(o),rt_f_list_label_id:h(c),rt_f_search_top_goods:h(d)}};return l.warn("detailsRecommend result",r,i,a,n,g),g}}];var g=r(640593),p=r(544764),f=r.n(p);function m(t,e){return t.get(function(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}(t,e))}var y=new WeakMap;const v=class{constructor(){(0,g.A)(this,y,"s_router_history_data"),this.toData={},this.fromData={}}init(){const t=new(f())(window.location.search),e={};t.forEach(((t,r)=>{e[r]=t})),this.toData={historyLength:window.history.length,path:window.location.pathname,query:e};try{var r;const t=(0,s.getSessionStorage)(m(y,this))||{};((null==t?void 0:t.historyLength)||0)<this.toData.historyLength-1||(null==t?void 0:t.path)===(null===(r=this.toData)||void 0===r?void 0:r.path)?this.fromData={}:this.fromData=Object.assign({},t)}catch(t){}this.updateSessionStorage(),this.addEvent(),this.handleTrigger()}addEvent(){}updateSessionStorage(){(0,s.setSessionStorage)({key:m(y,this),value:this.toData})}handleTrigger(){this.handler&&this.handler(this.toData,this.fromData)}registerHandler(t){this.handler=t}};var _=r(665640);function w(t=[],{debug:e=!1}){const r=new c({debug:e});window.analysisBeforeInterceptor&&window.analysisBeforeInterceptor.use((async t=>{var e,s;return r.triggerCollectDataHandlers(t.data),null!==(e=t.data)&&void 0!==e&&null!==(s=e.activity_param)&&void 0!==s&&s._actionId&&delete t.data.activity_param._actionId,t}));const s=function(t=[]){const e={};return t.forEach((t=>{const{collectDataInstance:s,routerActionInstance:i}=function(t){const e=new n(t),s=new o(t);return r.registerHandler({key:t.featureKey,collectDataInstance:e,routerActionInstance:s}),{collectDataInstance:e,routerActionInstance:s}}(t);e[t.featureKey]={get:()=>t.onTrigger({collectData:s.getData(),routerAction:i.getData()}),set(t,e){"collectData"===t?s.trigger(e):"routerAction"===t&&i.trigger(e)},onceSet(t,{to:e,from:r}){s.onceSet(t,{to:e,from:r})},startCollect(t){i.onStart(t.to,t.from)}}})),e}(t);return{trackingController:r,instances:s}}let I=null;function b(){var t;if("undefined"==typeof window||"1"==(null===(t=gbCommonInfo)||void 0===t?void 0:t.USER_ACTION_CLOSE))return;const e="1"==(0,s.getLocalStorage)("user_action_log")||window.location.href.includes("local-us.shein.com"),{instances:r,trackingController:i}=w(d,{debug:e});I=r,window._userActionTracker=I;const a=new v;a.registerHandler(((t,e)=>{try{i.triggerRouterActionHandlers({path:t.path,query:t.query},{path:e.path,query:e.query})}catch(t){_.error(t)}})),a.init()}function S(t){if(!I)return null;const e=I[t];return e?e.get():void 0}},939922:(t,e,r)=>{r.r(e),r.d(e,{default:()=>rt});var s=r(433623),i=r(360442),a=r(383112),n=r(973106);class o{static for({key:t}){return new(o.classes.find((e=>e.canHandle(t))))({key:t})}static canHandle(t){return!0}constructor({key:t}){this.key=t,this.cache=new Map}get(){return(0,i.getSessionStorage)(this.key)}set(t,e){(0,i.setSessionStorage)({key:this.key,value:t})}getSync(){return(0,i.getSessionStorage)(this.key)}clearStorage(){(0,i.removeSessionStorage)(this.key)}isLogin(){return!!(0,s.R)("memberId")}getMemberId(){return(0,s.R)("memberId")||""}async getIpCountryApi(){try{let t=await(0,a.A)({method:"POST",useBffApi:!0,url:"/user-api/address/update_country"});if(0==t.code){const{countryId:e="",countryAbbr:r=""}=(null==t?void 0:t.info)||{};return{countryId:e,countryAbbr:r}}return{}}catch(t){return{}}}async getUgidApi(){try{var t;const e="ugid_v2",r=null===(t=(0,n.T)([e]))||void 0===t?void 0:t[e];return await(r?async function(){var t;const e=await(0,a.A)({method:"get",useBffApi:!0,url:"/user-api/common/userinfo_ugid"});return(null==e||null===(t=e.info)||void 0===t?void 0:t.ugid)||""}():async function(){const t=await(0,a.A)({method:"post",url:"/api/common/userInfoManager/ugid"});return(null==t?void 0:t.info)||""}())}catch(t){return""}}}const c=o;var l=r(597874),u=r(665640);function h(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}let d=0,g=!1;const p=[],f=t=>{if(!p.length)return g=!1,!1;p.forEach((e=>{e(t)})),p.splice(0,p.length),g=!1},m="ipCountry";var y=new WeakSet;function v(){if("undefined"==typeof window)return!1;const t=window.localStorage.getItem(m),e=t?JSON.parse(t):{};null!=e&&e.end&&Date.now()>(null==e?void 0:e.end)-18e5&&this.update()}function _(){const t=(0,i.getLocalStorage)(m);return null!=t&&t.countryId?t:{}}const w=class extends c{constructor(...t){super(...t),(0,l.A)(this,y)}static canHandle(t){return"Country"===t}async get(t){if((null==t?void 0:t.reset)||!1){const t=await this.update();if(t.countryId)return t}const e=h(y,this,_).call(this);if(null!=e&&e.countryId)return h(y,this,v).call(this),e;return await this.update()}getSync(t){const e=h(y,this,_).call(this);return null!=e&&e.countryId&&h(y,this,v).call(this),e}set(t){if(null==t||!t.countryId||null==t||!t.countryAbbr)return u.error("missing parameter on set Country method"),!1;(0,i.setLocalStorage)({key:m,value:t,expire:2592e5})}clearStorage(){(0,i.removeLocalStorage)(m)}async update(){return new Promise((t=>{if(d>0&&Date.now()-d<2e4)return t(h(y,this,_).call(this)),!1;if(g)p.push((e=>{t(e)}));else{g=!0;const e=()=>{const e={countryId:"",countryAbbr:"",formatCountryAbbr:""};t(e),f(e)};this.getIpCountryApi().then((r=>{if(null==r||!r.countryId)return e(),!1;const s=(t=>{let e=t;return["SA","AE","KW","IL","JO","QA","OM","AR"].indexOf(t.toUpperCase())>-1?e="ar":(t=>["IN","IND"].indexOf(t.toUpperCase())>-1)(t)&&(e="in"),e})(r.countryAbbr),i={countryId:null==r?void 0:r.countryId,countryAbbr:null==r?void 0:r.countryAbbr,formatCountryAbbr:s};this.set(i),null!=i&&i.countryId&&(d=Date.now()),t(i),f(i)})).catch((t=>{u.error("UserKey.Country.update.error",t),e()}))}}))}};var I=r(794103);class b extends c{static canHandle(t){return"location"===t}async get(){let t=(0,i.getLocalStorage)("location")||"";return"Null"==t?"":(t||(t=await this.getServiceCache()),t||"")}getSync(){let t=(0,i.getLocalStorage)("location");return t||""}async set(t){const e=await this.setSerivceCache(t);"0"==(null==e?void 0:e.code)&&(0,i.setLocalStorage)({key:"location",value:t})}async setSerivceCache(t){const e={key:"location",actionType:"Location/setLocation",value:t};return await(0,a.A)({url:"/api/common/userInfoManager/update",method:"POST",data:e})}async getServiceCache(){const t=await(0,a.A)({url:"/api/common/userInfoManager/get",method:"GET",params:{key:"location",actionType:"Location/getLocation"}});if("0"==(null==t?void 0:t.code))return(0,i.setLocalStorage)({key:"location",value:(null==t?void 0:t.data)||"Null"}),(null==t?void 0:t.data)||""}}(0,I.A)(b,"cacheQue",[]);const S=b,{SUPPORT_LANGS:k,lang:R}=gbCommonInfo;const A=class extends c{static canHandle(t){return"language"===t}get(){let t=k[0]||R,e=(0,s.R)("language");return e&&k.includes(e)&&(t=e),t}async set(t,{}={}){return await(0,a.A)({url:"/api/common/language/update",params:{new_lang:t}}),t}};const C=class extends c{static canHandle(t){return"memberId"===t}get(){return(0,s.R)(this.key)||""}};var E=r(246752),T=r(665640);const P="userinfo_email";const L=class extends c{static canHandle(t){return t===P}getStorageUserinfoEmail(){let t="";try{let e=this.initStoreCacheKey();t=(0,i.getLocalStorage)(e)||""}catch(e){T.log("UserInfoManage Get UserEmail Error",e),t=""}return t}clearStorageUserinfoEmail(){try{let t=Object.keys(localStorage||{});t=t.filter((t=>t.includes(P))),t.length&&t.forEach((t=>(0,i.removeLocalStorage)(t)))}catch(t){T.log("clear localStorage error",t)}}initStoreCacheKey(){return`${this.getMemberId()}_${P}`}async get(){if(!this.isLogin())return this.clearStorageUserinfoEmail(),"";let t=this.getStorageUserinfoEmail();if(t)return t;let{data:e="",code:r=""}=await this.getServiceUserinfoEmail();if("0"===r){if(this.clearStorageUserinfoEmail(),e){let t=this.initStoreCacheKey();(0,i.setLocalStorage)({key:t,value:e,expire:36e5})}return e||""}return E.A.report({apiPath:"get/user-email/error",errorSubType:"get_user_email",errorType:"get_user_email_error",error_scene:"get_user_email_default"}),(0,s.R)(P)||""}getSync(){if(!this.isLogin())return this.clearStorageUserinfoEmail(),"";let t=this.getStorageUserinfoEmail();return t||((0,s.R)(P)||"")}async getServiceUserinfoEmail(){return await(0,a.A)({url:"/api/common/userInfoManager/get",params:{key:P,actionType:"getServiceUserInfoEmail"}})||{}}};var N=r(113131),O=r(704035),D=r(665640);const{default_currency:x,currencies:j}=gbCommonInfo,U="currency",J=Object.keys(j||{});let G=!1;const q=class extends c{static canHandle(t){return"currency"===t}get(){let t=x,e=(0,s.R)(U);e&&J.includes(e)&&(t=e);const r=(0,O.e)({key:"currency"});if(r&&"0"!=r&&gbCommonInfo.currency==r&&!G&&r!=t){const e=2592e3;t=r,(0,N.T)({key:U,value:t,curMainDomain:!0,end:e}),D.log("fix cdn query currency cookie")}return G=!0,t}async set(t,{isLog:e=0}={}){let r={currency:t};return 1==e&&Object.assign(r,{isLog:1,gbCur:gbCommonInfo.currency}),await(0,a.A)({url:"/api/common/currency/update",params:r}),t}};var $=r(236762);const H=$.mz,M=15552e5,V=["AuthToken","login_phone","modifyPassword","account_type","add_time","login_time_last","member_id","nickname","init_password"];const B=class extends c{static canHandle(t){return"UserInfo"===t}async getAuthUserInfo(){const t=await(0,a.A)({url:"/api/auth/authUserInfo/get"}),{code:e,info:r}=t||{};return 0==e&&r||{}}isNotEmpty(t){return"object"==typeof t&&null!=t&&Object.keys(t).length>0}filterObjectByKeys(t,e){return e.reduce(((e,r)=>void 0!==t[r]?{...e,[r]:t[r]}:e),{})}async get(t={}){const e=(null==t?void 0:t.noCache)||!1;if(!this.isLogin()&&!0!==e)return(0,i.removeLocalStorage)(H),{};let r={};return!0!==e&&(r=(0,i.getLocalStorage)(H)||{}),this.isNotEmpty(r)||(r=await this.getAuthUserInfo(),this.isNotEmpty(r)&&(0,i.setLocalStorage)({key:H,value:this.filterObjectByKeys(r||{},V),expire:M})),r}set(t,{}={}){const e=this.filterObjectByKeys(t||{},V);this.isNotEmpty(e)&&(0,i.setLocalStorage)({key:H,value:e,expire:M})}getSync(){if(!this.isLogin())return(0,i.removeLocalStorage)(H),{};return(0,i.getLocalStorage)(H)||{}}};let F=null,W=null,z=!1;const K=class extends c{static canHandle(t){return"ugid"===t}async get(){if(z)return this.getSync();F||(F=function(t,e){return Promise.race([t,new Promise((t=>setTimeout((()=>t(null)),e)))])}(this.getUgidApi(),5e3));const t=await F;return this.set(t),t}getSync(){return W}set(t=""){z=!0,W=t}clearStorage(){z=!1,W=null,F=null}};var X=r(46927);const Z="webpushcookie";const Y=class extends c{static canHandle(t){return t===Z}async get(){return(0,s.R)(Z)}set(t=""){(0,N.T)({key:Z,value:`agree:${t}`,end:31536e3})}clearStorage(){(0,X.z)({key:Z})}};var Q=r(674790);const tt=class extends c{static canHandle(t){return"oest"===t}get(){return Q.Lw.get()}set(){}};c.classes=[w,S,A,C,L,q,B,K,Y,tt];class et{static get({key:t,options:e,actionType:r=""}){return et.getActionLists.add(r),c.for({key:t}).get(e)}static set({key:t,value:e,options:r={},actionType:s=""}){return et.setActionLists.add(s),c.for({key:t}).set(e,r)}static getSync({key:t,options:e,actionType:r=""}){return et.getActionLists.add(r),c.for({key:t}).getSync(e)}static isLogin(){return!!(0,s.R)("memberId")}static switchLanguge(){}static clearStorage({key:t}){c.for({key:t}).clearStorage()}static clearAllStorage(){["Country","language","memberId","userinfo_email","pwa_user_email","ugid"].forEach((t=>{et.clearStorage({key:t})}))}}et.getActionLists=new Set,et.setActionLists=new Set;const rt=et},973106:(t,e,r)=>{r.d(e,{T:()=>h,p:()=>d});const s=["hk","mhk","rw","rwm"],i=s.concat(["id","mid","in","pwin","ru","mru","ma","pwma","vn","mvn","roe","mroe","ch","mch","se","mse","rwar","rwmx","rwau","rwca","rwit","rwes","rwde","rwfr","rwuk","rwus","rwmar","rwmmx","rwmau","rwmca","rwmit","rwmes","rwmde","rwmfr","rwmuk","rwmus"]),a=i.concat(["asia","masia","my","mmy","th","mth","tw","mtw","ph","mph","pt","mpt","nl","pwnl","pl","mpl"]),{SiteUID:n,NEW_BFF_VERSION_SWTICH:o,SSR_BFF_SWITCH:c}=gbCommonInfo,l={LEVEL1:s,LEVEL2:i,LEVEL3:a},u=(t,e=o)=>e?t.reduce(((t,r)=>{const s=e[r];if(s)if(1===s.length){var i;const e=s[0];t[r]="OPENALL"===e||e===n||(null===(i=l[e])||void 0===i?void 0:i.includes(n))||!1}else t[r]=s.includes(n);else t[r]=!1;return t}),{}):t.reduce(((t,e)=>(t[e]=!1,t)),{});function h(t){return u(t)}function d(t){return u(t,c)}}}]);
//# sourceMappingURL=44665-966652697b8904ff.js.map