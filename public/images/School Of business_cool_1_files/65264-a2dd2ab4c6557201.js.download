"use strict";(self.webpackChunkSHEIN_W=self.webpackChunkSHEIN_W||[]).push([[65264],{965264:(e,t,r)=>{r.d(t,{VK:()=>d,fZ:()=>m,lD:()=>v});r(665640);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,o,c,u=[],a=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;a=!1}else for(;!(a=(i=o.call(r)).done)&&(u.push(i.value),u.length!==t);a=!0);}catch(e){s=!0,n=e}finally{try{if(!a&&null!=r.return&&(c=r.return(),Object(c)!==c))return}finally{if(s)throw n}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,l(i.key),i)}}function u(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,r){return(t=l(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}var p=function(e){return e[e.Level0=0]="Level0",e[e.Level1=1]="Level1",e[e.Level2=2]="Level2",e[e.Level3=3]="Level3",e}(p||{}),f="_thumbnail_",h=["img.shein.com","img.romwe.com","img.ltwebstatic.com","file.ltwebstatic.com","imgdeal-test01.shein.com"],b={"320-720":720,"720-1080":720,"1080-1280":1080,"1280-1440":1280,"1440-1680":1440,"1680-1920":1680,"1920-3080":1920,"3080-4080":1920},v=u((function e(t){var r=this;a(this,e),s(this,"deviceWidth",0),s(this,"isSupportWebp",!1),s(this,"serverSupportWebp",!1),s(this,"isMoble",!1),s(this,"designSize",0),s(this,"calculateWidth",0),s(this,"score",0),s(this,"isServer",!1),s(this,"isCookieSet",!1),s(this,"isSupprotCut",!1),s(this,"currentScene",""),s(this,"sceneMap",{}),s(this,"init",(function(e){try{if(r.setIsServer(),r.setDeviceData(e),r.setSupportWebpState(),r.isServer)return;if(r.isSupportWebp)return void r.setLocaWebpState("true");r.serverSupportWebp&&r.checkClientSupportWebp()}catch(e){return}})),s(this,"setIsServer",(function(){r.checkIsServer()&&(r.isServer=!0)})),s(this,"setDeviceData",(function(e){var t=e.width,i=e.isMobile,n=e.score,o=e.isSupportWebp,c=e.isSupprotCut,u=e.sceneMap,a=e.scene;r.isMoble=i||!1,r.isSupprotCut=c||!1,r.serverSupportWebp=o||!1,r.deviceWidth=r.getDeviceWidth(t),r.score=n||0,r.sceneMap=u||{},r.currentScene=a||"",o&&(r.isSupportWebp=o),r.designSize=i?750:1366,r.calculateWidth=r.getCalculateWidth()})),s(this,"getDeviceWidth",(function(e){var t=e||r.getDefaultDeviceWidthByCookie();return!r.isMoble&&t<=1920?1920:t})),s(this,"getDefaultDeviceWidthByCookie",(function(){return r.isMoble?375:1366})),s(this,"setSupportWebpState",(function(){r.isServer||r.serverSupportWebp&&(r.isSupportWebp=Boolean(r.getLocalWebpState()))})),s(this,"checkClientSupportWebp",(function(){(r.checkSupportWebpByCanvas()||r.checkSupportWebpByElement())&&(r.isSupportWebp=!0,r.setLocaWebpState("true")),r.checkSupportWebpByBase64()})),s(this,"checkIsServer",(function(){return"undefined"==typeof window})),s(this,"getCalculateWidth",(function(){for(var e=Object.keys(b),t=r.isMoble?2*r.deviceWidth:r.deviceWidth,n=0;n<e.length;n++){var o=i(e[n].split("-"),2),c=o[0],u=o[1];if(t>=Number(c)&&t<Number(u)||n===e.length-1&&t>=Number(u))return r.calculateWidthByScore(n,e)}return 720})),s(this,"calculateWidthByScore",(function(e,t){var i=t[e];if(r.score===p.Level3||r.score===p.Level2||r.score===p.Level0)return b[i];r.score===p.Level1&&(i=t[e-1>=0?e-1:0]);return b[i]})),s(this,"getLocalKey",(function(){return"".concat("RESOURCE_ADAPT","__").concat("WEBP_SUPPORT")})),s(this,"getLocalWebpState",(function(){try{var e;return(null===(e=window)||void 0===e||null===(e=e.localStorage)||void 0===e?void 0:e.getItem(r.getLocalKey()))||!1}catch(e){return!1}})),s(this,"setLocaWebpState",(function(e){try{var t;if(null===(t=window)||void 0===t||null===(t=t.localStorage)||void 0===t||t.setItem(r.getLocalKey(),e),r.isCookieSet)return;r.isCookieSet=!0}catch(e){return}})),s(this,"checkSupportWebpByBase64",(function(){var e=new Image;e.onload=function(){e.width>0&&e.height>0&&!r.isSupportWebp&&(r.isSupportWebp=!0,r.setLocaWebpState("true"))},e.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="})),s(this,"checkSupportWebpByCanvas",(function(){var e=document.createElement("canvas");return e&&0===e.toDataURL("image/webp").indexOf("data:image/webp")})),s(this,"checkSupportWebpByElement",(function(){var e;try{var t=document,r=t.createElement("object");r.type="image/webp",r.innerHTML="!",t.body.appendChild(r),e=!r.offsetWidth,t.body.removeChild(r)}catch(t){e=!1}return e})),s(this,"cutWidth",(function(e,t,i){var n=e*r.calculateWidth/r.designSize;if(n=48*Math.round(n/48),i&&n<i)return i;if(t&&n>t)return t;var o=r.isMoble?2:4,c=Math.floor(e+48*o);return Math.floor(n)>c?c:Math.floor(n)})),s(this,"isSupportCutImgType",(function(e){return/\b(\.webp|\.png|\.jpg\b)/.test(e)})),s(this,"isSupportCutImg",(function(e){return h.some((function(t){return e.indexOf(t)>-1}))})),s(this,"img2Webp",(function(e,t){return t?e.replace(/\b(\.jpg|\.png|\.gif)\b/,".webp"):e})),s(this,"getCutToNum",(function(e,t,r){return r&&e<r?r:t&&e>t?t:e})),s(this,"checkIsGif",(function(e){return/\b(\.gif\b)/.test(e)})),s(this,"cutImg",(function(e){var t=e.imgUrl,n=e.width,o=e.max,c=e.min,u=e.cutTo,a=t.indexOf(f)>-1,s=r.cutWidth(n,o,c);if(a)return t.replace(/(\d+)x(\d*)(\.)(webp|png|jpg)$/,(function(e){var t=i(e.split("."),2),n=t[0],a=t[1],l=i(n.split("x"),1)[0];if(u&&"number"==typeof u&&!Number.isNaN(u)){var p=r.getCutToNum(u,o,c);return"".concat(p,"x.").concat(a)}var f=s>Number(l)?Number(l):s;return"".concat(f,"x.").concat(a)}));var l=t.lastIndexOf("."),p=t.slice(l);if(u&&"number"==typeof u&&!Number.isNaN(u)){var h=r.getCutToNum(u,o,c);return"".concat(t.slice(0,l)).concat(f).concat(h,"x").concat(p)}return"".concat(t.slice(0,l)).concat(f).concat(s,"x").concat(p)})),s(this,"transfromImg",(function(e){var t=e.imgUrl,i=void 0===t?"":t,n=e.width,o=void 0===n?0:n,c=e.exp,u=void 0===c?{}:c;try{var a=u||{},s=a.unCut,l=void 0===s?0:s,p=a.max,f=void 0===p?0:p,h=a.min,b=void 0===h?0:h,v=a.cutTo,d=void 0===v?0:v,m=a.useWebp,S=void 0===m?1:m,g=r.checkIsGif(i);if(!i)return"data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA=";var A=r.isSupportCutImg(i);r.isSupportWebp&&Number(S)&&(i=r.img2Webp(i,A));var y=!r.currentScene||r.sceneMap[r.currentScene]&&Boolean(r.sceneMap[r.currentScene]);return r.isSupprotCut&&A&&y&&o&&!l&&!g&&r.isSupportCutImgType(i)&&(i=r.cutImg({imgUrl:i,width:o,max:f,min:b,cutTo:Number(d)})),i.replace(/^\w+:/,"")}catch(e){return i}})),s(this,"updataScore",(function(e){r.score=e||0,r.calculateWidth=r.getCalculateWidth()})),s(this,"updateScene",(function(e){r.currentScene=e})),this.init(t)})),d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEXMzMzKUkQnAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="",r=Object.keys(e);return r.forEach((function(i,n){t+="".concat(i,"=").concat(e[i]).concat(n!==r.length-1?"#":"")})),t}}}]);
//# sourceMappingURL=65264-a2dd2ab4c6557201.js.map